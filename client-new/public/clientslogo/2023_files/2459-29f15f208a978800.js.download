"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2459],{89275:function(e,n,t){t.d(n,{e:function(){return h}});var r=t(55312),o=t(89303),a=t(24642),s=t.n(a),l=t(29901),i=t(81638),c=t(4403),u=t(65992),d=t(70012),m=t(67024),f=t(61250),x=function(e){var n=e.backgroundColor,t=e.onChange;return(0,f.jsxs)("div",{children:[(0,f.jsx)("h2",{className:"font-bold text-gray-900",children:"Background color"}),(0,f.jsx)("div",{className:"flex justify-between",children:(0,f.jsx)("div",{className:"mt-2 mb-1 text-sm text-gray-900",children:"Enter hex or select"})}),(0,f.jsx)("div",{children:(0,f.jsx)(m.ZE,{className:"text-sm rounded-md lf-input bg-gray-50 dark:border-transparent dark:bg-gray-700 dark:placeholder-gray-400 dark:focus:outline-none dark:focus:bg-white dark:focus:text-gray-900 dark:focus:placeholder-gray-500",color:n,onChange:t})}),(0,f.jsx)("div",{className:"mt-4 color-picker",children:(0,f.jsx)(m.gW,{color:n,onChange:t})})]})},p=t(30424),v=function(e){var n=e.animationBackgroundColor,t=e.buttonDisabled,r=e.handleColorChange,o=e.isLoading,a=e.resetColorChange,s=e.showButtons,l=e.submitColorChange;return(0,f.jsxs)("div",{children:[(0,f.jsx)(x,{backgroundColor:n,onChange:r}),s&&(0,f.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,f.jsx)(d.z,{fluid:!0,disabled:t,text:"Reset",variant:"secondary",onClick:a}),(0,f.jsx)(d.z,{showLoader:o,disabled:t,fluid:!0,text:"Update",variant:"primary",onClick:l})]})]})},h=function(e){var n=e.animationBackgroundColor,t=e.canUpdate,a=void 0===t||t,d=e.fileId,m=e.onChange,x=e.portalRoot,h=(0,l.useRef)(null),b=(0,l.useRef)(n),g=(0,i.Db)(p.IT),C=(0,o.Z)(g,2),y=C[0],j=C[1],k=(0,l.useCallback)((0,r.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b.current===n){e.next=5;break}return b.current=n,e.next=5,j({id:d,backgroundColor:n});case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),new Error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[n,d,b,j]),w=(0,l.useState)(!1),R=w[0],N=w[1],I=(0,l.useCallback)((function(e){m(e)}),[m]),F=(0,l.useCallback)((function(){I(b.current)}),[I]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(u.n,{ref:h,icon:"background-color",title:"Background color",onClick:function(){return N(!0)}}),R&&(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(c.J,{show:!0,container:x,offsetX:10,placement:"left-start",onClose:function(){return N(!1)},triggerElementRef:h,content:(0,f.jsx)(v,{buttonDisabled:b.current===n,showButtons:a,submitColorChange:k,resetColorChange:F,isLoading:y.fetching,animationBackgroundColor:n,handleColorChange:I})})})]})}},75737:function(e,n,t){t.d(n,{T:function(){return i}});var r=t(29901),o=t(42137),a=t(62879),s=t(61250),l=function(e,n){return"@".concat(n)},i=function(e){var n=e.defaultValue,t=e.inputRef,i=e.onChange,c=e.onFocus,u=e.markup,d=e.placeholder,m=e.rows,f=void 0===m?1:m,x=e.users,p=void 0===x?[]:x,v=(0,r.useMemo)((function(){return p.map((function(e){return{id:e.id,display:e.name,avatarUrl:e.avatarUrl}}))}),[p]),h=(0,r.useCallback)((function(e,n,t){var r,o=null!==(r=e.display)&&void 0!==r?r:"";return(0,s.jsxs)("div",{className:"flex flex-row items-center",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-8 h-8 mr-2",children:(0,s.jsx)(a.q,{name:o,avatarOnly:!0,large:!0})}),(0,s.jsx)("div",{className:"flex flex-col",children:(0,s.jsx)("div",{children:t})})]})}),[]);return(0,s.jsx)("div",{className:"w-full text-sm lf-font-base",children:(0,s.jsx)(o.r,{inputRef:t,value:u,defaultValue:n,placeholder:d,rows:f,allowSuggestionsAboveCursor:!0,onChange:i,onFocus:c,className:"comments-input",children:(0,s.jsx)(o.p,{trigger:"@",markup:"@{user:__display__:__id__}",displayTransform:l,data:v,appendSpaceOnAdd:!0,renderSuggestion:h,className:"comments-input"})})})}},90246:function(e,n,t){t.d(n,{a:function(){return l}});t(29901);var r=t(62879),o=t(47399),a=t(66700),s=t(61250),l=function(e){var n=e.createdAt,t=e.name;return(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 mr-2",children:(0,s.jsx)(r.q,{name:t,avatarOnly:!0})}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsxs)(o.Z,{className:"text-sm text-gray-900 font-lf-semi-bold",children:[t," "]}),(0,s.jsx)(o.Z,{variant:"caption-2",color:"gray",children:(0,s.jsx)(a.b,{date:n})})]})]})}},58768:function(e,n,t){t.d(n,{F:function(){return c}});var r=t(55312),o=t(24642),a=t.n(o),s=t(29901),l=t(70012),i=t(61250),c=function(e){var n=e.comment,t=e.onCancel,o=e.onDelete,c=(0,s.useCallback)((function(e){t(),e.stopPropagation()}),[t]),u=(0,s.useCallback)(function(){var e=(0,r.Z)(a().mark((function e(t){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(n.id),t.stopPropagation();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[n.id,o]);return(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-full space-y-2",children:[(0,i.jsx)("p",{className:"w-full text-sm text-center text-gray-600",children:"Delete this comment?"}),(0,i.jsxs)("div",{className:"flex space-x-2",children:[(0,i.jsx)(l.z,{text:"Cancel",variant:"secondary",onClick:c}),(0,i.jsx)(l.z,{text:"Delete",color:"red",onClick:u})]})]})}},10454:function(e,n,t){t.d(n,{z:function(){return l}});var r=t(29901),o=t(90246),a=t(26787),s=t(61250),l=function(e){var n,t,l,i=e.comment,c=e.mentionables,u=e.onCancel,d=e.onEdit,m=(0,r.useCallback)((function(e){var n=e.body;d(i.id,n)}),[i,d]);return(0,s.jsxs)("div",{className:"flex flex-col px-4 py-2",children:[i.nodeId&&(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("p",{className:"text-sm text-gray-400",children:i.nodeId})}),(0,s.jsx)(o.a,{name:null!==(n=null!==(t=null===(l=i.user)||void 0===l?void 0:l.name)&&void 0!==t?t:i.guestName)&&void 0!==n?n:"Anonymous",createdAt:new Date(i.createdAt)}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsx)(a._,{placeholder:"Edit your comment…",defaultValue:i.body,postButtonText:"Update",onCancel:u,onPost:m,mentionables:c})})]})}},26787:function(e,n,t){t.d(n,{_:function(){return u}});var r=t(83849),o=t.n(r),a=t(29901),s=t(75737),l=t(70012),i=t(16142),c=t(61250),u=function(e){var n=e.borderless,t=e.coordinates,r=e.defaultValue,u=void 0===r?"":r,d=e.frame,m=e.mentionables,f=e.onCancel,x=e.onPost,p=e.placeholder,v=void 0===p?"Add a comment. Use @ to mention.":p,h=e.postButtonText,b=void 0===h?"Comment":h,g=e.rows,C=void 0===g?1:g,y=(0,a.useRef)(null),j="number"==typeof d,k=(0,a.useState)(!1),w=k[0],R=k[1],N=(0,a.useRef)(null),I=(0,a.useState)(""),F=I[0],S=I[1];(0,a.useEffect)((function(){var e;null===(e=y.current)||void 0===e||e.focus(),R(!0)}),[y]),(0,i.Z)(y,(function(){w&&R(!1)}));var Z=(0,a.useCallback)((function(){R(!0)}),[]),E=(0,a.useCallback)((function(e){y.current&&0!==F.trim().length&&(x({body:F,frame:d,coordinates:t}),y.current.value=""),e.stopPropagation(),null==f||f(),S("")}),[f,x,d,F,t]),P=(0,a.useCallback)((function(e){y.current&&(y.current.value=""),e.stopPropagation(),null==f||f()}),[f]),D=(0,a.useCallback)((function(e,n){S(n)}),[]);return(0,c.jsx)("div",{className:"flex",ref:N,children:(0,c.jsx)("div",{className:o()({"flex w-full":!0}),children:(0,c.jsxs)("div",{className:"flex flex-col w-full space-y-1",children:[(0,c.jsxs)("div",{className:o()({"relative flex p-1 pb-0 items-center justify-center rounded-md bg-gray-50":!0,"border border-teal-200":!n&&w,"border border-gray-300":!n&&!w}),children:[j&&(0,c.jsxs)("span",{className:o()({"absolute flex items-center z-10 text-gray-600 bg-teal-200 text-xs px-1 rounded-md":!0,"left-1.5 top-[5px]":!n,"left-1 top-[6px]":n}),children:["#",d]}),(0,c.jsx)("div",{className:o()({"w-full relative flex items-center":!0,"indent-8":j&&1===d.toString().length,"indent-9":j&&2===d.toString().length,"indent-10":j&&d.toString().length>=3}),children:(0,c.jsx)(s.T,{inputRef:y,defaultValue:u,placeholder:v,rows:C,users:m,onChange:D,markup:F,onFocus:Z})})]}),(0,c.jsx)("div",{className:"flex-grow"}),(0,c.jsxs)("div",{className:"flex items-center",children:[(0,c.jsx)("div",{className:"flex-grow"}),(0,c.jsxs)("div",{className:"flex space-x-2",children:[(0,c.jsx)(l.z,{text:"Cancel",variant:"secondary",onClick:P}),(0,c.jsx)(l.z,{text:b||"Comment",onClick:E})]})]})]})})})}},3873:function(e,n,t){t.d(n,{j:function(){return d}});var r=t(55312),o=t(24642),a=t.n(o),s=t(29901),l=t(7092),i=t(2512),c=t(35378),u=t(61250),d=function(e){var n,t=e.commentId,o=e.container,d=e.currentUserId,m=e.isResolved,f=e.onDeleteClick,x=e.onEditClick,p=e.onResolve,v=e.onUnresolve,h=e.userId,b=(0,s.useState)(!1),g=b[0],C=b[1],y=function(){var e=(0,r.Z)(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v(t),n.stopPropagation();case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),j=(0,u.jsx)(l.h,{name:"meatball-menu",iconLighter:!0,hoverBackgroundClass:"hover:bg-gray-100",focusBackgroundClass:"focus:bg-gray-100",sizeClass:"h-8 w-8"}),k={label:"Resolve",icon:(0,u.jsx)(i.J,{name:"tick",color:"text-gray-500",marginRight:!0}),onClick:function(e){p(t),e.stopPropagation()}},w={label:"Open Discussion",icon:(0,u.jsx)(i.J,{name:"tick",color:"text-gray-500",marginRight:!0}),onClick:y},R=(0,s.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),x()}),[x]),N={label:"Edit",icon:(0,u.jsx)(i.J,{name:"pencil",color:"text-gray-500",marginRight:!0}),onClick:R},I={label:"Delete",icon:(0,u.jsx)(i.J,{name:"delete",marginRight:!0}),destructiveAction:!0,onClick:function(e){C(!0),f(),e.stopPropagation()}};return n=m?h&&h===d?[[w,N,I]]:[[w]]:h&&h===d?[[k,N,I]]:[[k]],(0,u.jsx)(u.Fragment,{children:(0,u.jsx)(c.h_,{forceClose:g,closeCallback:function(){return C(!1)},container:o,placement:"bottom-end",wrapperCssClasses:"absolute right-0 top-1",button:j,items:n,width:m?"w-44":"w-32"})})}},94328:function(e,n,t){t.d(n,{_:function(){return x}});var r=t(77916),o=t(51848),a=t(78733),s=t(29901),l=t(59524),i=t(61250),c=function(e){var n=e.frameNumber,t=e.onClick;return null==n?null:(0,i.jsx)(i.Fragment,{children:t?(0,i.jsx)("span",{className:"flex float-left bg-teal-200 px-2 rounded-md mr-2 font-small h-[20px]",children:(0,i.jsxs)("button",{type:"button",className:"text-xs text-teal-800 focus:outline-none",onClick:t,children:["#",n]})}):(0,i.jsxs)("span",{className:"px-1 mr-2 text-xs text-teal-800 bg-teal-200 rounded-md focus:outline-none",children:["#",n]})})},u=t(16824),d=["node"];function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var x=function(e){var n=e.body,t=e.frame,r=void 0!==t,m=(0,a.useRouter)(),x=m.pathname,p=m.push,v=m.query,h=(0,s.useCallback)((function(){v.frame="".concat(t),v.filter="keyframe-specific",p({pathname:x,query:v},void 0,{shallow:!0})}),[p,x,v,t]),b=(0,s.useMemo)((function(){return function(e){var n=e;(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(e){if(e.type===u.ow.User){var t=e.user,r=t.id,o=t.name,a=new RegExp("@{user:.+?:".concat(r,"}"),"gu");n=n.replace(a,"**@".concat(o,"**"))}}));var t=/@\{user:((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+?):[0-9a-f]{8}(?:\x2D[0-9a-f]{4}){3}\x2D[0-9a-f]{12}\}/g;return n=n.replace(t,"**@$1**")}(n)}),[n]);return(0,i.jsxs)("p",{className:"mt-2 break-words",children:[r?(0,i.jsx)(c,{frameNumber:t,onClick:h}):(0,i.jsx)(i.Fragment,{}),(0,i.jsx)("span",{className:"text-sm text-gray-600 font-lf-base",children:(0,i.jsx)(l.D,{components:{strong:function(e){e.node;var n=(0,o.Z)(e,d);return(0,i.jsx)("strong",f(f({},n),{},{className:"font-bold text-gray-600"}))}},children:b})})]})}},69896:function(e,n,t){t.d(n,{W:function(){return G},H:function(){return r}});var r,o=t(83849),a=t.n(o),s=t(29901),l=t(78733),i=t(46019),c=t(69452),u=t(7092),d=t(2512),m=t(96772),f=t(16824),x=t(61250),p=function(e){var n=e.comments,t=e.iconButton,r=void 0!==t&&t,o=(0,l.useRouter)(),a=o.pathname,i=o.push,p=o.query,v=(0,s.useMemo)((function(){var e=n?(0,f.Lt)(n).map((function(e){return{label:"#".concat(e),value:String(e)}})):[];return[{label:"All",value:"all"}].concat((0,c.Z)(e))}),[n]),h=(0,s.useCallback)((function(e){null===e.value||p.frame==="".concat(e.value)?delete p.frame:p.frame="".concat(e.value),i({pathname:a,query:p},void 0,{shallow:!0})}),[a,p,i]),b=(0,s.useMemo)((function(){return r?(0,x.jsx)(u.h,{name:"filter"}):(0,x.jsx)(m.nR,{wrapperCssClasses:"flex text-gray-600 hover:bg-gray-50 hover:text-gray-600 transition-colors rounded-md h-8 items-center px-2 font-lf-regular",label:"Frame-specific",rightControl:(0,x.jsx)(d.J,{name:"chevron-right",color:"text-gray-500"})})}),[r]);return(0,x.jsx)(m.ud,{button:b,wrapperCssClasses:r?"absolute right-0":"absolute left-3",placement:r?"right-end":"right-start",options:v,onChange:h,width:"w-24",staticButton:!0})},v=function(e){var n=e.comments,t=(0,l.useRouter)(),r=t.pathname,o=t.push,a=t.query,i=(0,s.useRef)(),c=(0,s.useMemo)((function(){return[{label:"All",value:"all"},(0,x.jsx)(p,{comments:n},1),{label:"Non-frame-specific",value:"non-frame-specific"},{label:"Show Resolved",value:"resolved"}]}),[n]),u=(0,s.useCallback)((function(e){"all"===e.value?(delete a.frame,delete a.resolved):"non-frame-specific"===e.value?a.frame="none":"resolved"===e.value&&("yes"===a.resolved?delete a.resolved:a.resolved="yes"),o({pathname:r,query:a},void 0,{shallow:!0})}),[a,r,o]);return(0,s.useEffect)((function(){a.frame?"none"===a.frame?i.current=c.find((function(e){return"non-frame-specific"===e.value})):i.current=(0,x.jsx)(m.nR,{wrapperCssClasses:"flex text-gray-600 hover:bg-gray-100 hover:text-gray-600 transition-colors rounded-md h-8 items-center px-2 font-lf-regular",label:"Frame-specific",rightControl:(0,x.jsx)(d.J,{name:"chevron-right",color:"text-gray-500"})}):i.current=c[0]}),[a.frame,c]),(0,x.jsx)(m.ud,{button:i.current,wrapperCssClasses:"absolute right-0",placement:"bottom-end",options:c,onChange:u,width:"w-56"})},h=function(e){var n=e.comments,t=(0,l.useRouter)(),r=t.pathname,o=t.push,a=t.query,i=(0,s.useCallback)((function(){"frame"in a&&delete a.frame,o({pathname:r,query:a},void 0,{shallow:!0})}),[r,a,o]);return(0,x.jsx)("div",{className:"px-6 py-2",children:(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)(v,{comments:n}),(0,x.jsx)("div",{className:"flex-grow"}),"frame"in a&&(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"flex items-center h-6 text-xs text-teal-800 bg-teal-200 rounded-md",children:[(0,x.jsxs)("span",{className:"mr-2",children:["#",a.frame]}),(0,x.jsx)("button",{type:"button",className:"text-teal-700",onClick:i,children:(0,x.jsx)(d.J,{name:"cross",className:"h-2.5 w-2.5"})})]})}),"frame"in a&&(0,x.jsx)(p,{iconButton:!0})]})})},b=t(26787),g=t(47399),C=t(29100),y=t(16142),j=t(40810),k=function(e){var n=e.isExpanded,t=e.mentionables,r=e.onCollapse,o=e.onExpand,l=e.onPost,c=(0,s.useState)(!1),u=c[0],d=c[1],m=(0,i.useRecoilValue)(j.m9),f=(0,s.useRef)(null),p=(0,i.useRecoilValue)(j.h3);(0,y.Z)(f,(function(){r(),d(!1)}));var v=(0,s.useCallback)((function(e){d(e)}),[]),h=(0,s.useCallback)((function(){r(),d(!1)}),[r]),k=(0,s.useCallback)((function(e){l(e),h()}),[h,l]);return p?null:(0,x.jsx)("div",{className:"flex px-6",ref:f,children:(0,x.jsx)("div",{className:a()({"relative flex w-full border bg-gray-50 rounded-md":!0,"py-2 px-4 border-gray-200 shadow":!n,"p-2 border-teal-200":n}),children:n?(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"flex flex-col items-start w-full space-y-2",children:[(0,x.jsx)(C.X,{label:"",valueLabel:"Frame-specific",onChange:v,labelClass:"text-xs",checked:u}),(0,x.jsx)("div",{className:"w-full",children:u?(0,x.jsx)(b._,{postButtonText:"Post",placeholder:"Add a comment. Use @ to mention.",borderless:!0,frame:m,mentionables:t,onCancel:h,onPost:k,rows:3}):(0,x.jsx)(b._,{postButtonText:"Post",placeholder:"Add a comment. Use @ to mention.",mentionables:t,borderless:!0,onCancel:h,onPost:k,rows:3})})]})}):(0,x.jsx)("div",{className:"py-2",onClick:o,role:"presentation",children:(0,x.jsx)(g.Z,{children:"Add a comment. Use @ to mention."})})})})},w=function(){return(0,x.jsxs)("div",{className:"p-6 space-y-4",children:[(0,x.jsx)("h4",{className:"text-gray-900 text-md font-lf-bold",children:"Add comments in 3 ways"}),(0,x.jsxs)("div",{className:"flex items-start text-sm font-light text-gray-600",children:[(0,x.jsxs)("svg",{className:"w-12 h-10 mr-4",viewBox:"0 0 28 27",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,x.jsx)("path",{d:"M24.2822 19.289L12.6388 8.03903C12.6387 7.9466 12.6149 7.85564 12.5697 7.77418C12.5245 7.69273 12.4592 7.62329 12.3796 7.57202C12.3 7.52074 12.2086 7.48921 12.1133 7.48021C12.0181 7.47121 11.9221 7.48502 11.8337 7.52041C11.7454 7.55581 11.6674 7.6117 11.6067 7.68314C11.546 7.75458 11.5044 7.83938 11.4857 7.93002C11.467 8.02067 11.4717 8.11437 11.4994 8.20285C11.5271 8.29132 11.5769 8.37184 11.6445 8.43728V24.014C11.644 24.1197 11.6744 24.2233 11.7321 24.313C11.7898 24.4026 11.8726 24.4748 11.9708 24.5211C12.0691 24.5674 12.1789 24.5859 12.2876 24.5747C12.3962 24.5634 12.4994 24.5227 12.5853 24.4573L15.5415 22.223L18.1217 26.7095C18.195 26.8358 18.3157 26.9302 18.4589 26.9731C18.6021 27.016 18.7568 27.0042 18.8913 26.9402L22.3843 25.2527C22.4547 25.2188 22.5172 25.1715 22.568 25.1136C22.6189 25.0557 22.6571 24.9884 22.6803 24.9158C22.7035 24.8433 22.7112 24.7669 22.7029 24.6914C22.6947 24.6158 22.6707 24.5427 22.6323 24.4764L20.2023 20.2498H23.87C23.9853 20.25 24.0981 20.2171 24.194 20.1553C24.2899 20.0935 24.3647 20.0056 24.4088 19.9027C24.453 19.7998 24.4645 19.6865 24.442 19.5773C24.4194 19.468 24.3638 19.3677 24.2822 19.289Z",fill:"currentColor"}),(0,x.jsx)("path",{d:"M9.14242 15.1142C7.31122 14.3218 5.88005 12.86 5.1628 11.0494C4.44556 9.23887 4.5008 7.22736 5.31641 5.45609C7.01867 1.77509 11.5037 0.119086 15.3122 1.75934C17.1434 2.55174 18.5746 4.01354 19.2918 5.82411C20.0091 7.63468 19.9538 9.64619 19.1382 11.4175C19.0754 11.5537 19.0711 11.7084 19.1264 11.8477C19.1816 11.9869 19.2918 12.0992 19.4328 12.16C19.5738 12.2207 19.7339 12.2248 19.8781 12.1714C20.0222 12.118 20.1384 12.0115 20.2013 11.8753C20.6716 10.8643 20.9298 9.7733 20.961 8.66528C20.9922 7.55727 20.7957 6.45427 20.3829 5.42009C19.9758 4.38368 19.3599 3.43565 18.5708 2.63094C17.7818 1.82623 16.8352 1.18086 15.7861 0.732211C11.3919 -1.16341 6.21644 0.749086 4.25337 4.99821C3.7833 6.00927 3.52523 7.1003 3.49405 8.20828C3.46288 9.31625 3.65922 10.4192 4.07173 11.4535C4.4788 12.4899 5.09473 13.4379 5.8838 14.2426C6.67287 15.0473 7.6194 15.6927 8.66853 16.1413C8.80865 16.1972 8.9658 16.1981 9.10656 16.1437C9.24733 16.0894 9.36061 15.9842 9.42233 15.8504C9.48405 15.7166 9.48933 15.5649 9.43706 15.4274C9.38479 15.2899 9.27908 15.1776 9.14242 15.1142Z",fill:"currentColor"}),(0,x.jsx)("path",{d:"M10.5093 12.0073C10.0232 11.7905 9.58642 11.4827 9.22428 11.1017C8.86213 10.7207 8.5818 10.274 8.39951 9.78764C8.21448 9.30229 8.13093 8.7863 8.15372 8.26954C8.1765 7.75278 8.30516 7.24553 8.53224 6.77714C8.75646 6.30736 9.07498 5.88527 9.46932 5.53534C9.86366 5.18541 10.326 4.91461 10.8295 4.73864C11.3318 4.56011 11.8658 4.47952 12.4006 4.50153C12.9354 4.52355 13.4604 4.64772 13.9452 4.86689C14.4314 5.08354 14.8683 5.39129 15.2305 5.77232C15.5926 6.15334 15.8729 6.60004 16.055 7.08652C16.4288 8.07427 16.381 9.14414 15.9223 10.097C15.864 10.2314 15.8618 10.3825 15.9163 10.5184C15.9707 10.6544 16.0776 10.7646 16.2144 10.826C16.3512 10.8875 16.5073 10.8953 16.65 10.8479C16.7926 10.8005 16.9107 10.7015 16.9795 10.5718C17.2716 9.96949 17.437 9.31718 17.4661 8.65267C17.4953 7.98816 17.3877 7.32466 17.1495 6.70064C16.9149 6.0753 16.5544 5.50109 16.0887 5.0112C15.6231 4.52131 15.0615 4.12545 14.4366 3.84652C13.8132 3.56451 13.1381 3.40478 12.4504 3.37659C11.7627 3.3484 11.076 3.45229 10.4301 3.68227C9.7829 3.90892 9.18862 4.25728 8.6816 4.7072C8.17457 5.15712 7.76488 5.69968 7.47619 6.30352C7.18413 6.9058 7.01872 7.5581 6.98954 8.22261C6.96036 8.88713 7.06799 9.55062 7.30619 10.1746C7.54078 10.8 7.90132 11.3742 8.36697 11.8641C8.83262 12.354 9.39415 12.7498 10.0191 13.0288C10.1579 13.0833 10.3132 13.0842 10.4526 13.0311C10.5921 12.978 10.705 12.8751 10.7681 12.7438C10.8311 12.6124 10.8394 12.4626 10.7912 12.3255C10.743 12.1883 10.6421 12.0744 10.5093 12.0073Z",fill:"currentColor"})]}),(0,x.jsx)("p",{children:"Click on an animation to add an annotated comment that’s specific to a frame."})]}),(0,x.jsxs)("div",{className:"flex items-start text-sm font-light text-gray-600",children:[(0,x.jsx)("svg",{className:"w-12 h-10 mr-4",viewBox:"0 0 20 17",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M8.5554 0.335026C13.0204 0.335026 16.6402 3.16494 16.6402 6.65624C16.6402 10.1475 13.0204 12.9775 8.5554 12.9775C8.13408 12.9778 7.71317 12.952 7.29525 12.9004C5.55863 14.5721 3.55359 14.871 1.54856 14.9158V14.5065C2.63085 13.9961 3.50293 13.067 3.50293 12.0046C3.50293 11.8567 3.49107 11.7109 3.46843 11.5682C1.64019 10.409 0.470581 8.63937 0.470581 6.6552C0.470581 3.1639 4.09043 0.333984 8.5554 0.333984V0.335026ZM17.2471 14.5044C17.2471 15.4147 17.8583 16.2115 18.7973 16.649V17C17.0606 16.9625 15.4663 16.7052 13.9604 15.2731C13.6046 15.3158 13.2392 15.3387 12.8684 15.3387C11.26 15.3387 9.77891 14.92 8.59637 14.2148C11.0337 14.2065 13.3341 13.4524 15.0782 12.088C15.9286 11.434 16.6306 10.6178 17.1404 9.6903C17.7356 8.60321 17.9988 7.37507 17.8993 6.149C19.1217 7.1239 19.8742 8.45397 19.8742 9.91944C19.8742 11.6203 18.8609 13.1368 17.2762 14.1305C17.2567 14.2542 17.247 14.3792 17.2471 14.5044Z",fill:"currentColor"})}),(0,x.jsx)("p",{children:"Click the comment button next to the timeline to add a comment on a specific frame."})]}),(0,x.jsxs)("div",{className:"flex items-start text-sm font-light text-gray-600",children:[(0,x.jsx)("svg",{className:"w-6 h-6 mr-4",viewBox:"0 0 25 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,x.jsx)("path",{d:"M13.5594 22H7.34965C5.59021 22 4.24475 20.7 4.24475 19V5C4.24475 3.3 5.59021 2 7.34965 2H13.5594V4H7.34965C6.72867 4 6.31468 4.4 6.31468 5V19C6.31468 19.6 6.72867 20 7.34965 20H13.5594V22ZM19.7692 7H20.8042V5H19.7692C18.9413 5 18.2168 5.3 17.6993 5.8C17.1818 5.3 16.4573 5 15.6294 5H14.5944V7H15.6294C16.1468 7 16.6643 7.5 16.6643 8V16C16.6643 16.5 16.1468 17 15.6294 17H14.5944V19H15.6294C16.4573 19 17.1818 18.7 17.6993 18.2C18.2168 18.7 18.9413 19 19.7692 19H20.8042V17H19.7692C19.2517 17 18.7343 16.5 18.7343 16V8C18.7343 7.5 19.2517 7 19.7692 7Z",fill:"currentColor"})}),(0,x.jsx)("p",{children:"Enter your comment in the text box above."})]})]})},R=t(90246),N=t(58768),I=t(10454),F=t(3873),S=t(94328),Z=t(47302),E=t(47579),P=t(31054),D=t(64167),M=function(e){var n,t,r,o,l,c,u=e.comment,m=e.currentUserId,f=e.mentionables,p=e.onDelete,v=e.onEdit,h=e.onReply,b=e.onResolve,C=e.onSelectReaction,y=e.onUnresolve,k=(0,s.useState)(!1),w=k[0],M=k[1],U=(0,s.useState)(!1),A=U[0],B=U[1],V=(0,s.useState)(!1),L=V[0],O=V[1],T=(0,s.useRef)(null),q=(0,i.useRecoilValue)(j.h3),J=(0,s.useCallback)((function(){M(!0)}),[]),z=(0,s.useCallback)((function(){M(!1)}),[]),_=(0,s.useCallback)((function(){B(!1)}),[]),H=(0,s.useCallback)((function(e,n){v(e,n),B(!1)}),[v]),G=(0,s.useCallback)((function(e){h(u),e.stopPropagation()}),[h,u]),X=(0,s.useCallback)((function(){B(!0)}),[]),K=(0,s.useCallback)((function(){O(!0)}),[]),Y=(0,s.useCallback)((function(){O(!1)}),[]),Q=(0,s.useCallback)((function(e){O(!1),p(e)}),[p]),W=(0,s.useCallback)((function(e,n){C(u.id,e,n)}),[u,C]);return(0,x.jsx)("div",{className:"px-6 py-1",children:A?(0,x.jsx)("div",{className:"rounded-md bg-gray-50 hover:bg-gray-100",children:(0,x.jsx)(I.z,{comment:u,mentionables:f,onCancel:_,onEdit:H})}):(0,x.jsxs)("div",{ref:T,className:"relative flex flex-col px-4 py-2 rounded-md bg-gray-50 hover:bg-gray-100",onMouseEnter:J,onMouseLeave:z,onClick:G,role:"presentation",children:[(u.nodeId||u.resolvedAt)&&(0,x.jsxs)("div",{className:"flex",children:[u.nodeId&&(0,x.jsx)(g.Z,{variant:"caption-1",color:"gray",children:u.nodeId}),u.resolvedAt&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"flex-grow"}),(0,x.jsx)(P.u,{title:(0,D.h5)(u.resolvedAt).toLocaleString(),children:(0,x.jsx)(d.J,{name:"tick",color:"text-green-500"})})]})]}),(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)(R.a,{name:null!==(n=null!==(t=null===(r=u.user)||void 0===r?void 0:r.name)&&void 0!==t?t:u.guestName)&&void 0!==n?n:"Anonymous",createdAt:new Date(u.createdAt)}),(0,x.jsx)("div",{className:"flex-grow"}),m&&!q&&(0,x.jsx)("div",{className:"flex-shrink-0",children:(0,x.jsxs)("div",{className:a()("flex flex-row",{hidden:!w}),children:[(0,x.jsx)(E.j,{commentId:u.id,onSelect:C,hoverBackgroundClassName:"hover:bg-gray-100"}),T.current&&(0,x.jsx)(F.j,{currentUserId:m,userId:null===(o=u.user)||void 0===o?void 0:o.id,commentId:u.id,isResolved:Boolean(u.resolvedAt),container:T.current,onDeleteClick:K,onEditClick:X,onResolve:b,onUnresolve:y})]})})]}),(0,x.jsxs)("div",{className:"flex-1",children:[(0,x.jsx)(S._,{body:u.body,frame:null===(l=u.extra)||void 0===l?void 0:l.frame,mentions:u.mentions}),(0,x.jsxs)("div",{className:"flex items-center mt-2",children:["number"==typeof u.replyCount&&u.replyCount>0&&(0,x.jsxs)("div",{className:"flex items-center text-gray-400 text-cs",children:[(0,x.jsx)(d.J,{name:"comment"}),(0,x.jsx)("p",{children:u.replyCount})]}),!u.resolvedAt&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{className:"flex-grow"}),(0,x.jsx)("button",{type:"button",className:"text-xs text-gray-900 hover:text-teal-600 focus:outline-none",onClick:G,children:q?"Replies":"Reply"})]})]}),Boolean(null===(c=u.reactions)||void 0===c?void 0:c.length)&&(0,x.jsx)("div",{className:"relative mt-2",children:(0,x.jsx)(Z.U,{reactions:u.reactions,currentUserId:m,onReactionClick:W})})]}),L&&(0,x.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-white border border-gray-200 rounded-md bg-opacity-95",children:(0,x.jsx)(N.F,{comment:u,onDelete:Q,onCancel:Y})})]})})},U=t(95282),A=function(e){var n=e.canFetchMoreComments,t=e.currentUserId,r=e.discussions,o=e.isFetchingComments,a=e.mentionables,s=e.onDelete,l=e.onEdit,i=e.onFetchMoreComments,c=e.onReplyClick,u=e.onResolve,d=e.onSelectReaction,m=e.onUnresolve,f=(0,U.S)({onIntersecting:i});return r.length?(0,x.jsxs)(x.Fragment,{children:[r.map((function(e){return(0,x.jsx)(M,{mentionables:a,currentUserId:t,comment:e.node,onDelete:s,onEdit:l,onResolve:u,onSelectReaction:d,onUnresolve:m,onReply:c},e.node.id)})),n&&!o&&(0,x.jsx)("span",{ref:f})]}):null},B=t(41837),V=function(e){var n=e.canFetchMoreComments,t=e.currentUserId,r=e.discussions,o=e.isFetching,a=e.isInputExpanded,c=e.mentionables,u=e.onCollapseInput,d=e.onDelete,m=e.onEdit,f=e.onExpandInput,p=e.onFetchMoreComments,v=e.onPost,b=e.onReplyClick,g=e.onResolve,C=e.onSelectReaction,y=e.onUnresolve,R=(0,l.useRouter)().query,N=(0,i.useRecoilValue)(j.h3),I=(0,s.useMemo)((function(){if(!r)return[];var e=[],n=e="none"===R.frame?r.filter((function(e){var n;return void 0===(null===(n=e.node.extra)||void 0===n?void 0:n.frame)})):"all"===R.frame?r.filter((function(e){var n;return"number"==typeof(null===(n=e.node.extra)||void 0===n?void 0:n.frame)})):void 0===R.frame&&R.frame?r.filter((function(e){var n,t=e.node;return"".concat(null===(n=t.extra)||void 0===n?void 0:n.frame)==="".concat(R.frame)})):r;return"yes"===R.resolved&&(n=e.filter((function(e){return e.node.resolvedAt}))),n.sort((function(e,n){var t=e.node,r=n.node;return new Date(r.createdAt).getTime()-new Date(t.createdAt).getTime()}))}),[r,R]);return!N||r&&r.length?N||r&&r.length||!o?(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(k,{mentionables:c,onPost:v,onCollapse:u,onExpand:f,isExpanded:a}),(0,x.jsx)(h,{comments:r}),r&&r.length?(0,x.jsx)(A,{currentUserId:t,discussions:I,mentionables:c,canFetchMoreComments:n,isFetchingComments:o,onDelete:d,onEdit:m,onReplyClick:b,onResolve:g,onSelectReaction:C,onUnresolve:y,onFetchMoreComments:p}):(0,x.jsx)(w,{})]}):(0,x.jsx)(B.a,{}):(0,x.jsx)("div",{className:"px-5 mt-4 text-sm text-gray-900",children:"No comments."})},L=t(89303),O=function(e){var n,t,r,o,l,c,u=e.comment,m=e.currentUserId,f=e.onDelete,p=e.onEdit,v=e.onResolve,h=e.onSelectReaction,b=e.onUnresolve,g=null!==(n=null!==(t=null===(r=u.user)||void 0===r?void 0:r.name)&&void 0!==t?t:u.guestName)&&void 0!==n?n:"Anonymous",C=(0,s.useRef)(null),y=s.useState(!1),k=(0,L.Z)(y,2),w=k[0],M=k[1],U=s.useState(!1),A=(0,L.Z)(U,2),B=A[0],V=A[1],O=s.useState(!1),T=(0,L.Z)(O,2),q=T[0],J=T[1],z=(0,i.useRecoilValue)(j.h3),_=(0,s.useCallback)((function(){M(!0)}),[]),H=(0,s.useCallback)((function(){M(!1)}),[]),G=(0,s.useCallback)((function(){V(!0)}),[]),X=(0,s.useCallback)((function(){J(!0)}),[]),K=(0,s.useCallback)((function(e){f(e),J(!1)}),[f]),Y=(0,s.useCallback)((function(){J(!1)}),[]),Q=(0,s.useCallback)((function(e,n){h(u.id,e,n)}),[h,u.id]),W=(0,s.useCallback)((function(e,n){p(e,n),V(!1)}),[p]),$=(0,s.useCallback)((function(){V(!1)}),[]);return B?(0,x.jsx)("div",{className:"px-2 py-1",children:(0,x.jsx)(I.z,{comment:u,onCancel:$,onEdit:W})}):(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"flex flex-col border-b-[1px] border-gray-200 py-4",ref:C,onMouseEnter:_,onMouseLeave:H,children:[(0,x.jsxs)("div",{className:"flex",children:[(0,x.jsx)(R.a,{name:g,createdAt:new Date(u.createdAt)}),(0,x.jsx)("div",{className:"flex-grow"}),m&&!z&&(0,x.jsx)("div",{className:"flex-shrink-0",children:(0,x.jsxs)("div",{className:a()("flex flex-row",{hidden:!w}),children:[(0,x.jsx)(E.j,{commentId:u.id,onSelect:h}),C.current&&(0,x.jsx)(F.j,{currentUserId:m,userId:null===(o=u.user)||void 0===o?void 0:o.id,commentId:u.id,isResolved:Boolean(u.resolvedAt),container:C.current,onDeleteClick:X,onEditClick:G,onResolve:v,onUnresolve:b})]})}),u.resolvedAt&&(0,x.jsx)("div",{className:"flex-shrink-0",children:(0,x.jsx)(P.u,{title:(0,D.h5)(u.resolvedAt).toLocaleString(),children:(0,x.jsx)(d.J,{name:"tick",color:"text-green-500"})})})]}),(0,x.jsx)("div",{className:"text-sm",children:(0,x.jsx)(S._,{body:u.body,frame:null===(l=u.extra)||void 0===l?void 0:l.frame,mentions:u.mentions})}),Boolean(null===(c=u.reactions)||void 0===c?void 0:c.length)&&(0,x.jsx)("div",{className:"relative mt-2",children:(0,x.jsx)(Z.U,{reactions:u.reactions,currentUserId:m,onReactionClick:Q})}),q&&(0,x.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-white border border-gray-200 rounded-md bg-opacity-95",children:(0,x.jsx)(N.F,{comment:u,onDelete:K,onCancel:Y})})]})})},T=t(60873),q=function(e){var n,t=e.currentUserId,r=e.onDelete,o=e.onEdit,a=e.onResolve,s=e.onSelectReaction,l=e.onUnresolve,i=e.parentCommentId,c=(0,T.J)({parentCommentId:i}),u=c.canFetchMoreReplies,d=c.onFetchMoreReplies,m=c.repliesQuery,f=(0,U.S)({onIntersecting:d});return!m.data&&m.fetching?(0,x.jsx)(B.a,{size:"xs",type:"spinner"}):(0,x.jsxs)("div",{className:"pl-8",children:[null===(n=m.data)||void 0===n?void 0:n.commentReplies.edges.map((function(e){return(0,x.jsx)(O,{currentUserId:t,comment:e.node,onDelete:r,onEdit:o,onResolve:a,onSelectReaction:s,onUnresolve:l},e.node.id)})),u&&!m.fetching&&(0,x.jsx)("span",{ref:f})]})},J=t(75737),z=t(70012),_=function(e){var n=e.mentionables,t=e.onReply,r=(0,i.useRecoilValue)(j.h3),o=(0,s.useRef)(null),l=(0,s.useRef)(null),c=(0,s.useState)(!1),u=c[0],d=c[1],m=(0,s.useState)(""),f=m[0],p=m[1];(0,y.Z)(o,(function(){d(!1)}));var v=(0,s.useCallback)((function(e){l.current&&(t(f),l.current.value=""),e.stopPropagation(),p("")}),[t,f]),h=(0,s.useCallback)((function(e,n){p(n)}),[]);return r?null:(0,x.jsx)("div",{className:"flex",ref:o,children:(0,x.jsx)("div",{className:a()({"p-2 h-36 flex w-full border bg-gray-50 rounded-md":!0,"border-gray-100":!u,"border-teal-200":u}),children:(0,x.jsxs)("div",{className:"relative flex flex-col w-full",children:[(0,x.jsx)("div",{className:"absolute w-full",children:(0,x.jsx)("div",{className:"flex w-full p-2 m-2",children:(0,x.jsx)(J.T,{inputRef:l,"aria-label":"Reply",placeholder:"Reply",rows:3,users:n,markup:f,onChange:h,onFocus:function(){return d(!0)}})})}),(0,x.jsx)("div",{className:"flex-grow"}),(0,x.jsxs)("div",{className:"flex items-center",children:[(0,x.jsx)("div",{className:"flex-grow"}),(0,x.jsx)("div",{className:"flex",children:(0,x.jsx)(z.z,{text:"Reply",onClick:v,disabled:Boolean(!u)})})]})]})})})},H=function(e){var n=e.currentUserId,t=e.mentionables,r=e.onDelete,o=e.onEdit,a=e.onPostReply,l=e.onResolve,i=e.onSelectReaction,c=e.onUnresolve,u=e.parentComment,d=(0,s.useCallback)((function(e){a(u.id,e)}),[a,u.id]);return(0,x.jsxs)("div",{className:"flex flex-col w-full h-full",children:[(0,x.jsxs)("div",{className:"flex flex-col flex-1 h-full overflow-auto",children:[(0,x.jsx)("div",{className:"px-6",children:(0,x.jsx)(O,{currentUserId:n,comment:u,onDelete:r,onEdit:o,onResolve:l,onUnresolve:c,onSelectReaction:i})}),(0,x.jsx)("div",{className:"px-6",children:(0,x.jsx)(q,{currentUserId:n,parentCommentId:u.id,onDelete:r,onEdit:o,onResolve:l,onSelectReaction:i,onUnresolve:c})})]}),(0,x.jsx)("div",{className:"px-6 mt-2 mb-10",children:(0,x.jsx)(_,{mentionables:t,onReply:d})})]})};!function(e){e.DiscussionMode="discussion",e.ReplyMode="reply"}(r||(r={}));var G=function(e){var n=e.canFetchMoreComments,t=e.currentUserId,o=e.discussions,l=e.isFetchingDiscussions,i=e.isInputExpanded,c=e.mentionables,u=e.mode,d=e.onCollapseInput,m=e.onDelete,f=e.onEdit,p=e.onExpandInput,v=e.onFetchMoreComments,h=e.onPost,b=e.onReply,g=e.onReplyClick,C=e.onResolve,y=e.onSelectReaction,j=e.onUnresolve,k=e.parentDiscussion,w=(0,s.useCallback)((function(e){g(e)}),[g]),R=(0,s.useCallback)((function(){g(null)}),[g]);return(0,x.jsxs)("div",{className:"flex flex-col flex-grow h-full overflow-hidden",children:[u===r.DiscussionMode?(0,x.jsx)("div",{className:"flex items-center py-6",children:(0,x.jsx)("h3",{className:"pl-6 pr-2 text-base text-gray-900 font-lf-bold",children:"Comments"})}):(0,x.jsx)("div",{className:"relative w-full bg-white",children:(0,x.jsx)("div",{className:"flex items-center p-6 text-gray-600",children:(0,x.jsxs)("button",{className:"flex items-center",type:"button","data-testid":"close-button",onClick:R,children:[(0,x.jsxs)("svg",{className:"w-4 h-4 mr-4",viewBox:"0 0 17 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,x.jsx)("path",{d:"M7 1L1 7L7 13",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),(0,x.jsx)("path",{d:"M1 7L16 7",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})]}),(0,x.jsx)("h3",{className:"text-xl font-lf-bold",children:"Replies"})]})})}),(0,x.jsxs)("div",{className:a()("flex-1 h-[80vh] overflow-auto",{}),children:[u===r.DiscussionMode&&(0,x.jsx)(V,{canFetchMoreComments:n,currentUserId:t,discussions:o,isFetching:l,isInputExpanded:i,mentionables:c,onCollapseInput:d,onDelete:m,onEdit:f,onExpandInput:p,onPost:h,onReplyClick:w,onResolve:C,onSelectReaction:y,onFetchMoreComments:v,onUnresolve:j}),u===r.ReplyMode&&k&&(0,x.jsx)(H,{currentUserId:t,mentionables:c,parentComment:k,onDelete:m,onEdit:f,onResolve:C,onUnresolve:j,onPostReply:b,onSelectReaction:y})]})]})}},47302:function(e,n,t){t.d(n,{U:function(){return p}});var r=t(29901),o=t(55312),a=t(24642),s=t.n(a),l=t(83849),i=t.n(l),c=t(58265),u=t(61250),d=(0,c.default)((0,o.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([t.e(3434),t.e(7741)]).then(t.bind(t,77741)));case 1:case"end":return e.stop()}}),e)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[77741]},modules:["../components/page/animation/comment/reaction-counter.tsx -> ./emoji"]}}),m=function(e){var n=e.count,t=e.emoji,o=e.onClick,a=e.userHasReacted,s=void 0!==a&&a,l=(0,r.useCallback)((function(e){o(t,s),e.stopPropagation()}),[o,s,t]);return(0,u.jsx)("button",{type:"button",className:i()("flex items-center h-5 px-1 py-1 border border-opacity-0 hover:border-opacity-1 rounded-md text-gray-400 hover:text-gray-700",{"hover:border-gray-700 bg-gray-100":!s,"hover:border-teal-200 bg-teal-50":s}),onClick:l,children:(0,u.jsx)(r.Suspense,{fallback:null,children:(0,u.jsxs)("div",{className:"flex items-center space-x-1 cursor-pointer",children:[(0,u.jsx)(d,{id:t,size:"12px"}),(0,u.jsx)("p",{className:"text-xs",children:n})]})})},"reaction-counter-".concat(t))},f=(0,r.memo)(m),x=function(e){var n=e.reactions,t=void 0===n?[]:n,o=e.onReactionClick,a=e.currentUserId,s=(0,r.useMemo)((function(){var e=[];return null!=t&&t.length?(t.forEach((function(n){var t,r,o=e.find((function(e){return e.emoji===n.type}));o?(o.count+=1,o.userHasReacted=Boolean(o.userHasReacted)||(null===(t=n.user)||void 0===t?void 0:t.id)===a):(o={emoji:n.type,count:1,userHasReacted:(null===(r=n.user)||void 0===r?void 0:r.id)===a},e.push(o))}),[]),e):e}),[a,t]),l=(0,r.useMemo)((function(){return s.map((function(e){return(0,u.jsx)("li",{children:(0,u.jsx)(f,{emoji:e.emoji,count:e.count,userHasReacted:e.userHasReacted,onClick:o})},"reaction-count-".concat(e.emoji))}))}),[s,o]);return s.length?(0,u.jsx)("ul",{className:"flex flex-row space-x-1",children:l}):null},p=(0,r.memo)(x)},47579:function(e,n,t){t.d(n,{j:function(){return b}});var r=t(55312),o=t(24642),a=t.n(o),s=t(50136),l=t(83849),i=t.n(l),c=t(58265),u=t(29901),d=t(2512),m=t(61250),f=(0,c.default)((0,r.Z)(a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([t.e(3434),t.e(7741)]).then(t.bind(t,77741)));case 1:case"end":return e.stop()}}),e)}))),{ssr:!1,loadableGenerated:{webpack:function(){return[77741]},modules:["../components/page/animation/comment/reaction-selector.tsx -> ./emoji"]}}),x=[{id:"+1"},{id:"heart"},{id:"joy"},{id:"open_mouth"},{id:"pensive"},{id:"angry"}],p=function(e){var n=e.emojiId,t=e.onClick,r=e.size,o=void 0===r?"18px":r,a=(0,u.useCallback)((function(){t(n)}),[t,n]);return(0,m.jsx)("button",{className:"flex items-center w-5 h-5 transform rounded-full hover:scale-110",type:"button","data-text":n,onClick:a,children:(0,m.jsx)(f,{id:n,size:o})})},v=(0,u.memo)(p),h=function(e){var n=e.commentId,t=e.hoverBackgroundClassName,r=e.hoverTextColorClassName,o=e.onSelect,a=(0,u.useCallback)((function(e){o(n,e,!1)}),[n,o]),l=(0,u.useMemo)((function(){return x.map((function(e){var n=e.id;return(0,m.jsx)("li",{className:"px-1",children:(0,m.jsx)(v,{emojiId:n,onClick:a})},"reaction-item-".concat(n))}))}),[a]),c=(0,u.useCallback)((function(e){e.stopPropagation()}),[]);return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)(s.J2,{className:"relative",onClick:c,children:[(0,m.jsx)(s.J2.Button,{children:(0,m.jsx)("div",{className:i()("p-1 rounded-full",t,r),children:(0,m.jsx)(d.J,{name:"reaction",color:"text-gray-500"})})}),(0,m.jsx)(s.J2.Panel,{className:"absolute top-[-2rem] right-0 z-10",children:(0,m.jsx)(u.Suspense,{fallback:null,children:(0,m.jsx)("ul",{className:"flex flex-row items-center px-3 py-2 bg-white rounded-full shadow-sm",children:l})})})]})})},b=u.memo(h)},44663:function(e,n,t){t.d(n,{G:function(){return Y}});var r=t(89303),o=t(83849),a=t.n(o),s=t(78733),l=t(29901),i=t(13230),c=t(46019),u=t(40810),d=t(51705),m=function(e){var n=e.marker;return n.ratio?{left:n.x*n.ratio.x,top:n.y*n.ratio.y}:{left:0,top:0}},f=t(16010),x=t(55312),p=t(24642),v=t.n(p),h=t(81638),b=t(4403),g=t(61250),C=function(e){var n=e.children,t=e.closeRef,r=e.container,o=e.content,a=e.forceOpen;return(0,g.jsx)(b.J,{container:r,closeRef:t,show:a,placement:"right-start",offsetX:-15,additionalCssClasses:"w-80 z-10",content:o,children:n})},y=t(90246),j=t(58768),k=t(10454),w=t(3873),R=t(94328),N=t(47302),I=t(47579),F=t(2512),S=t(31054),Z=t(64167),E=function(e){var n,t,r,o,s,i,d=e.comment,m=e.currentUserId,f=e.mentionables,x=e.onDelete,p=e.onEdit,v=e.onResolve,h=e.onSelectReaction,b=e.onUnresolve,C=(0,l.useState)(!1),E=C[0],P=C[1],D=(0,l.useState)(!1),M=D[0],U=D[1],A=(0,c.useRecoilValue)(u.h3),B=(0,l.useState)(!1),V=B[0],L=B[1],O=(0,l.useRef)(null),T=(0,l.useCallback)((function(){P(!0)}),[]),q=(0,l.useCallback)((function(){P(!1)}),[]),J=(0,l.useCallback)((function(){L(!0)}),[]),z=(0,l.useCallback)((function(e){x(e),L(!1)}),[x]),_=(0,l.useCallback)((function(){L(!1)}),[]),H=(0,l.useCallback)((function(){U(!0)}),[]),G=(0,l.useCallback)((function(e,n){p(e,n),U(!1)}),[p]),X=(0,l.useCallback)((function(){U(!1)}),[]),K=(0,l.useCallback)((function(e,n){h(d.id,e,n)}),[h,d]);return(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("div",{className:"relative",children:[M?(0,g.jsx)(k.z,{mentionables:f,onEdit:G,onCancel:X,comment:d}):(0,g.jsxs)("div",{className:"p-4",ref:O,onMouseEnter:T,onMouseLeave:q,children:[(0,g.jsxs)("div",{className:"flex items-center",children:[(0,g.jsx)(y.a,{name:null!==(n=null!==(t=null===(r=d.user)||void 0===r?void 0:r.name)&&void 0!==t?t:d.guestName)&&void 0!==n?n:"Anonymous",createdAt:new Date(d.createdAt)}),(0,g.jsx)("div",{className:"flex-grow"}),m&&!A&&(0,g.jsx)("div",{className:"flex-shrink-0",children:(0,g.jsxs)("div",{className:a()("flex flex-row",{hidden:!E}),children:[(0,g.jsx)(I.j,{commentId:d.id,onSelect:h}),O.current&&(0,g.jsx)(w.j,{currentUserId:m,userId:null===(o=d.user)||void 0===o?void 0:o.id,commentId:d.id,isResolved:Boolean(d.resolvedAt),container:O.current,onDeleteClick:J,onEditClick:H,onResolve:v,onUnresolve:b})]})}),d.resolvedAt&&(0,g.jsx)("div",{className:"flex-shrink-0",children:(0,g.jsx)(S.u,{title:(0,Z.h5)(d.resolvedAt).toLocaleString(),children:(0,g.jsx)(F.J,{name:"tick",color:"text-green-500"})})})]}),(0,g.jsx)("div",{className:"flex-1",children:(0,g.jsx)(R._,{body:d.body,frame:null===(s=d.extra)||void 0===s?void 0:s.frame,mentions:d.mentions})}),Boolean(null===(i=d.reactions)||void 0===i?void 0:i.length)&&(0,g.jsx)("div",{className:"relative mt-2",children:(0,g.jsx)(N.U,{reactions:d.reactions,currentUserId:m,onReactionClick:K})})]}),V&&(0,g.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-white border border-gray-200 rounded-md bg-opacity-95",children:(0,g.jsx)(j.F,{comment:d,onDelete:z,onCancel:_})})]})})},P=t(26787),D=t(95282),M=t(60873),U=t(16824),A=function(e){var n,t,r,o,s=e.comment,i=e.currentUserId,d=e.mentionables,f=e.onDelete,p=e.onEdit,h=e.onReply,b=e.onResolve,y=e.onSelectReaction,j=e.onUnresolve,k=e.portal,w=(0,l.useState)(!0),R=w[0],N=w[1],I=(0,l.useState)("Reply"),F=I[0],S=I[1],Z=(0,c.useRecoilValue)(u.h3),A=(null===(n=s.extra)||void 0===n?void 0:n.type)===U.CX.Annotation?null===(t=s.extra)||void 0===t?void 0:t.annotation:null,B=(0,l.useRef)(null),V=(0,M.J)({parentCommentId:s.id}),L=V.canFetchMoreReplies,O=V.onFetchMoreReplies,T=V.repliesQuery,q=(0,D.S)({onIntersecting:O}),J=(0,l.useMemo)((function(){var e,n,t,r,o,a;return m({marker:{x:null!==(e=null==A?void 0:A.x)&&void 0!==e?e:0,y:null!==(n=null==A?void 0:A.y)&&void 0!==n?n:0,ratio:{x:null!==(t=null==A||null===(r=A.ratio)||void 0===r?void 0:r[0])&&void 0!==t?t:0,y:null!==(o=null==A||null===(a=A.ratio)||void 0===a?void 0:a[1])&&void 0!==o?o:1}}})}),[A]),z=(0,l.useCallback)(function(){var e=(0,x.Z)(v().mark((function e(n){return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(s.id,n.body);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[h,s.id]),_=(0,l.useCallback)((function(){s.resolvedAt?(N(!1),S("Open to reply")):N(!0)}),[s.resolvedAt]),H=(0,l.useCallback)((function(){N(!1)}),[]),G=(0,l.useCallback)((function(){j(s.id)}),[j,s]),X=null!==(r=null===(o=T.data)||void 0===o?void 0:o.commentReplies.edges)&&void 0!==r?r:[],K=X.length>0;return(0,g.jsx)(C,{container:k,closeRef:B,content:(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("div",{ref:null,className:a()([{"divide-y divide-black-500":K}]),children:[(0,g.jsx)(E,{comment:s,currentUserId:i,onDelete:f,onEdit:p,onResolve:b,onSelectReaction:y,onUnresolve:j,mentionables:d}),(0,g.jsxs)("div",{className:"overflow-y-auto max-h-80",children:[X.map((function(e){return(0,g.jsx)(E,{comment:e.node,currentUserId:i,onDelete:f,onEdit:p,onSelectReaction:y,onResolve:b,onUnresolve:j,mentionables:d},e.node.id)})),L&&!T.fetching&&(0,g.jsx)("span",{ref:q})]}),!Z&&(0,g.jsx)(g.Fragment,{children:s.resolvedAt?(0,g.jsx)("button",{type:"button",className:"flex justify-end w-full p-4 text-sm text-gray-900 border-t border-gray-100",onClick:G,children:"Click to open discussion"}):(0,g.jsx)(g.Fragment,{children:R?(0,g.jsx)("div",{className:a()({"p-2 px-4 pt-0 w-full":!0,"pt-4":K}),children:(0,g.jsx)(P._,{onCancel:H,borderless:!0,placeholder:"Reply. Use @ to mention",postButtonText:"Reply",mentionables:d,onPost:z})}):(0,g.jsx)("div",{className:"flex justify-end p-4 text-sm text-gray-900",children:(0,g.jsx)("button",{type:"button",onClick:_,children:F})})})})]})}),children:(0,g.jsxs)("div",{className:"absolute z-10 flex w-6 h-6 -m-3 group",style:{left:"".concat(J.left,"%"),top:"".concat(J.top,"%")},children:[(0,g.jsx)("span",{className:"absolute inline-flex w-full h-full bg-orange-500 rounded-full group-hover:animate-ping bg-opacity-30"}),(0,g.jsx)("div",{className:"relative inline-flex items-center justify-center w-full text-xs text-center bg-orange-500 border-2 border-orange-500 rounded-full bg-opacity-70 focus:outline-none",children:s.nodeId})]})})},B=t(64048),V=function(e){var n,t,o,a=e.currentFrame,s=e.currentUserId,i=e.entityId,c=e.entityType,u=e.isPlaying,d=e.mentionables,m=e.onDelete,f=e.onEdit,p=e.onReply,b=e.onResolve,C=e.onSelectReaction,y=e.onUnresolve,j=e.portal,k=(0,h.aM)({query:B.IP,variables:{id:i,type:c,frame:a,first:12},pause:!i||!c||u}),w=(0,r.Z)(k,1)[0],R=(0,l.useMemo)((function(){var e,n;return null!==(e=null===(n=w.data)||void 0===n?void 0:n.timelineCommentsByFrame.edges.map((function(e){return e.node})).filter((function(e){var n;return(null===(n=e.extra)||void 0===n?void 0:n.type)===U.CX.Annotation})))&&void 0!==e?e:[]}),[null==w||null===(n=w.data)||void 0===n?void 0:n.timelineCommentsByFrame.edges.length]),N=(0,h.m8)(),I=(0,l.useCallback)((0,x.Z)(v().mark((function e(){var n,t;return v().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.data&&!w.fetching){e.next=2;break}return e.abrupt("return");case 2:if(null!==(n=w.data.timelineCommentsByFrame.pageInfo)&&void 0!==n&&n.hasNextPage){e.next=4;break}return e.abrupt("return");case 4:if(null!==(t=w.data.timelineCommentsByFrame.pageInfo)&&void 0!==t&&t.endCursor){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,N.query(B.IP,{id:i,type:c,frame:a,after:w.data.timelineCommentsByFrame.pageInfo.endCursor,first:12}).toPromise();case 9:return e.prev=9,e.finish(9);case 11:case"end":return e.stop()}}),e,null,[[6,,9,11]])}))),[N,w.data,w.fetching,i,c,a]),F=null===(t=w.data)||void 0===t||null===(o=t.timelineCommentsByFrame.pageInfo)||void 0===o?void 0:o.hasNextPage,S=w.fetching,Z=(0,D.S)({onIntersecting:I});return(0,g.jsxs)(g.Fragment,{children:[null==R?void 0:R.map((function(e){return(0,g.jsx)(A,{portal:j,currentUserId:s,comment:e,mentionables:d,onDelete:m,onEdit:f,onReply:p,onResolve:b,onSelectReaction:C,onUnresolve:y},e.id)})),F&&!S&&(0,g.jsx)("span",{ref:Z})]})},L=function(e){var n=e.container,t=e.coordinates,r=e.frame,o=e.mentionables,a=e.onPost,s=e.setShow,i=e.show,c=e.totalFrames,u=void 0===c?0:c,d=e.triggerElement,m=Math.round(100*(r||0)/u),f=(0,l.useCallback)((function(){s(!1)}),[s]);return(0,g.jsx)(g.Fragment,{children:t?(0,g.jsx)(b.J,{container:n,onClose:f,triggerElementRef:d,content:(0,g.jsx)(P._,{mentionables:o,onPost:a,onCancel:f,frame:r,coordinates:t}),show:i}):(0,g.jsx)(b.J,{onClose:f,container:n,content:(0,g.jsx)(P._,{mentionables:o,onPost:a,onCancel:f,frame:r}),show:i,children:(0,g.jsx)("span",{className:"absolute w-1 h-4 -mt-1",style:{left:"".concat(m,"%")}})})})},O=function(e){var n=e.annotateComment,t=e.mentionables,r=e.onPost,o=e.portalRoot,a=e.setAnnotateComment,s=(0,l.useRef)(null),i=(0,c.useRecoilValue)(u.hF),d=(0,c.useRecoilValue)(u.m9),f=(0,l.useMemo)((function(){var e=m({marker:i});return{left:"".concat(e.left,"%"),top:"".concat(e.top,"%")}}),[i]);return(0,g.jsxs)("div",{children:[(0,g.jsx)("span",{ref:s,className:"absolute z-10 w-5 h-5 -m-3 bg-orange-500 border-2 border-orange-500 rounded-full bg-opacity-70",style:f}),(0,g.jsx)(L,{container:o,frame:d,coordinates:i,mentionables:t,triggerElement:s,show:n,setShow:a,onPost:r})]})},T=t(7092),q=t(83802),J=function(e){var n=e.max,t=e.onChange,r=e.value,o=Math.trunc(r/n*100),a=function(e){var r=parseFloat(e.target.value),o=Math.trunc(r/100*n);t(o)},s={backgroundImage:"-webkit-gradient(linear, left top, right top, color-stop(".concat(o,"%, #00DDB3), color-stop(").concat(o,"%, #D9E0E6))"),width:"100%"};return(0,g.jsx)("div",{className:"inline-flex flex-grow",children:(0,g.jsx)("input",{type:"range",className:"player-seeker",onChange:a,onInput:a,value:o,style:s})})},z=t(53620),_=t(49046),H=function(e){var n,t=e.commentPortalRoot,o=e.currentFrame,s=e.entityId,i=e.entityType,m=e.instance,f=e.isLight,x=e.mentionables,p=e.onPostComment,v=e.player,b=e.playing,C=e.showComments,y=void 0!==C&&C,j=(0,c.useSetRecoilState)(u.m9),k=(0,c.useRecoilValue)(u.h3),w=(0,c.useRecoilState)(d.sq),R=(0,r.Z)(w,2)[1],N=(0,c.useRecoilState)(d.vQ),I=(0,r.Z)(N,2)[1],F=(0,h.aM)({query:B.kF,variables:{id:s,type:i},pause:!y||!s||!i||b}),Z=(null===(n=(0,r.Z)(F,1)[0].data)||void 0===n?void 0:n.timelineCommentsCount)||[],E=(0,l.useMemo)((function(){return[.5,1,1.5,2,2.5]}),[]),P=(0,c.useRecoilState)(u.yQ),D=(0,r.Z)(P,1)[0],M=(0,l.useState)(null==m?void 0:m.loop),U=M[0],A=M[1],V=(0,l.useCallback)((function(){var e=U;A(!e),v.setLoop(!e)}),[U,v]),O=(0,l.useState)(E[1]),H=O[0],G=O[1],X=(0,l.useCallback)((function(){var e=E.indexOf(H);-1!==e&&e<E.length-1?(G(E[e+1]),null==m||m.setSpeed(E[e+1])):(G(E[0]),null==m||m.setSpeed(E[0]))}),[m,H,E]),K=(0,l.useState)(!1),Y=K[0],Q=K[1],W=(0,l.useState)(0)[1],$=(0,l.useState)(0),ee=$[0],ne=$[1],te=(0,c.useRecoilState)(u.fu),re=(0,r.Z)(te,2),oe=re[0],ae=re[1],se=(0,l.useCallback)((function(){Y||m&&(ne(o||0),m.isPaused||m.pause(),W(Math.floor(100*(o||0)/m.totalFrames))),Y||"comments"===oe||ae("comments"),Q(!Y)}),[o,oe,m,ae,Y]),le=(0,l.useCallback)((function(){I(!1),null!=m&&m.isPaused?(R(1),v.play()):v.pause()}),[m,v,I,R]),ie=(0,l.useMemo)((function(){return(0,g.jsx)(z.z,{keys:["space"]})}),[]);return(0,_.Z)({key:" ",action:le}),(0,_.Z)({key:"ArrowRight",action:function(){m&&m.currentFrame<m.totalFrames&&m.goToAndStop(m.currentFrame+1,!0)}}),(0,_.Z)({key:"ArrowLeft",action:function(){m&&m.currentFrame>0&&m.goToAndStop(m.currentFrame-1,!0)}}),(0,g.jsxs)("div",{className:"flex items-center mt-16 space-x-4",children:[(0,g.jsx)(S.u,{placement:"top",title:b?"Pause":"Play",shortcut:ie,children:(0,g.jsx)(T.h,{name:b?"pause":"play",rounded:!0,hoverIconClass:"hover:text-gray-600",iconClass:a()({"text-white":f,"text-gray-600":!f}),hoverBackgroundClass:"bg-transparent",noFocus:!0,onClick:le})}),(0,g.jsxs)("div",{className:"relative flex w-full",children:[y&&"comments"===oe&&Z.map((function(e){if("number"!=typeof e.count||!D)return(0,g.jsx)(g.Fragment,{});var n=Number.parseInt(e.key,10),t=Math.trunc(n/D*100),r=e.count;return(0,g.jsx)("div",{className:"absolute w-1",style:{left:"".concat(t,"%")},onClick:function(){return j(n)},role:"presentation",children:(0,g.jsx)(S.u,{placement:"top",title:"".concat(r," ").concat((0,q._)({count:r,singular:"comment"})," on #").concat(null!=n?n:0),children:(0,g.jsxs)("div",{className:"relative w-6 h-6 cursor-pointer -mt-7",children:[(0,g.jsx)("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full",children:(0,g.jsx)("svg",{viewBox:"0 0 22 21",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,g.jsx)("path",{d:"M11 0C17.0749 0 22 4.07579 22 9.10415C22 14.1325 17.0749 18.2083 11 18.2083C10.4268 18.2087 9.85408 18.1717 9.28547 18.0973C6.92267 20.505 4.19467 20.9355 1.46667 21V20.4105C2.9392 19.6754 4.12573 18.3373 4.12573 16.8072C4.12573 16.5942 4.1096 16.3842 4.0788 16.1787C1.59133 14.509 0 11.9604 0 9.10265C0 4.07429 4.92507 0 11 0Z",fill:"#2B343B"})})}),(0,g.jsx)("div",{className:"absolute top-0 left-0 flex items-center justify-center w-full h-full",children:(0,g.jsx)("p",{className:"text-xs text-white",children:r})})]})})},"frame-".concat(n))})),(0,g.jsx)(J,{max:D||1,value:o||0,onChange:function(e){v.setSeeker(e,!1),I(!1)}}),y&&Y&&!k&&(0,g.jsx)(L,{container:t,frame:ee,totalFrames:D,show:Y,onPost:p,setShow:Q,mentionables:x})]}),(0,g.jsxs)("div",{className:"flex space-x-2",children:[(0,g.jsx)(T.h,{name:!0===U?"loop":"no-loop",rounded:!0,hoverIconClass:"hover:text-gray-600",hoverBackgroundClass:"bg-gray-100",noFocus:!0,onClick:V,iconClass:"text-gray-500",backgroundClass:"bg-gray-100"}),(0,g.jsxs)("button",{type:"button",className:"flex items-center justify-center w-10 h-10 text-xs text-gray-900 bg-gray-100 rounded-md hover:text-gray-600 focus:outline-none",onClick:X,children:[H,"x"]}),!k&&(0,g.jsx)(S.u,{title:"Add comment",placement:"top-start",children:(0,g.jsx)(T.h,{name:"comment-fill",rounded:!0,hoverIconClass:Y?"hover:text-teal-600":"hover:text-gray-600",hoverBackgroundClass:"bg-gray-100",noFocus:!0,onClick:se,iconClass:!0===Y?"text-teal-600":"text-gray-500",backgroundClass:!0===Y?"bg-teal-200":"bg-gray-100"})})]})]})},G=function(e){var n=e.currentFrame,t=e.totalFrames;return(0,g.jsx)("div",{className:"ml-10",children:(0,g.jsxs)("span",{className:"px-2 py-1 text-xs text-gray-900 bg-gray-100 rounded-lg",children:["# ",(0,g.jsx)("span",{style:{minWidth:"24px",display:"inline-block"},children:n})," /"," ",(0,g.jsx)("span",{style:{minWidth:"24px",display:"inline-block"},children:t})]})})},X=(0,l.memo)(G),K=t(78170),Y=function(e){var n=e.animationUrl,t=e.canComment,o=e.controls,m=e.currentDiscussion,x=e.currentUserId,p=e.entityId,v=e.entityType,h=e.isLight,b=e.mentionables,C=e.onDeleteComment,y=e.onEditComment,j=e.onPostComment,k=e.onReplyToComment,w=e.onResolveComment,R=e.onSelectReaction,N=e.onUnresolveComment,I=e.portalRoot,F=e.showComments,S=(0,s.useRouter)().query,Z=m,E=l.useRef(null),P=l.useRef(null),D=(0,l.useState)(!1),M=D[0],U=D[1],A=(0,c.useRecoilState)(u.hF),B=(0,r.Z)(A,2)[1],L=(0,c.useRecoilState)(u.EG),T=(0,r.Z)(L,1)[0],q=(0,c.useRecoilValue)(u.Hw),J=(0,c.useRecoilState)(d.YC),z=(0,r.Z)(J,2)[1],_=(0,c.useRecoilState)(u.fu),G=(0,r.Z)(_,2),Y=G[0],Q=G[1];(0,l.useEffect)((function(){var e=["border","border-gray-300"];q?e.map((function(e){var n,t;return null===(n=E.current)||void 0===n||null===(t=n.container)||void 0===t?void 0:t.classList.add(e)})):e.map((function(e){var n,t;return null===(n=E.current)||void 0===n||null===(t=n.container)||void 0===t?void 0:t.classList.remove(e)}))}),[q,E]);var W=(0,l.useState)(null),$=W[0],ee=W[1],ne=(0,c.useRecoilState)(u.m9),te=(0,r.Z)(ne,2),re=te[0],oe=te[1],ae=(0,c.useRecoilState)(u.yQ),se=(0,r.Z)(ae,2),le=se[0],ie=se[1],ce=(0,c.useRecoilState)(d.IS),ue=(0,r.Z)(ce,2),de=ue[0],me=ue[1],fe=(0,c.useRecoilState)(d.sq),xe=(0,r.Z)(fe,2),pe=xe[0],ve=xe[1],he=(0,c.useRecoilState)(d.VY),be=(0,r.Z)(he,1)[0],ge=(0,c.useRecoilState)(d.vQ),Ce=(0,r.Z)(ge,2),ye=Ce[0],je=Ce[1],ke=(0,c.useRecoilState)(d.kF),we=(0,r.Z)(ke,2),Re=we[0],Ne=we[1],Ie=(0,c.useRecoilState)(d.GS),Fe=(0,r.Z)(Ie,1)[0],Se=(0,l.useCallback)((function(e){var n,t,r=e.currentTarget;null!==(n=E.current)&&void 0!==n&&null!==(t=n.container)&&void 0!==t&&t.contains(e.target)&&(E.current.pause(),Q("comments"),U(!0),me(!1),B(function(e){var n=e.container,t=e.x,r=e.y,o=n.getBoundingClientRect(),a=2048/o.width,s=2048/o.height;return{x:t-o.x,y:r-o.y,ratio:{x:a/2048*100,y:s/2048*100}}}({container:r,x:e.clientX,y:e.clientY})))}),[Q,B,me]),Ze=(0,l.useCallback)((function(e){var n,t;null!==(n=E.current)&&void 0!==n&&null!==(t=n.container)&&void 0!==t&&t.contains(e.target)&&("mouseenter"===e.type&&Re?E.current.play():"mouseleave"===e.type&&Re&&E.current.pause())}),[Re]);(0,l.useEffect)((function(){E.current&&$&&Math.floor($.currentFrame)!==re&&E.current.setSeeker(re)}),[re,E,$]),(0,l.useEffect)((function(){S.frame&&("all"===S.frame?oe(0):S.frame&&oe(Number(S.frame))),S.filter&&"all"===S.filter&&oe(0)}),[S,oe,Z]),(0,l.useEffect)((function(){var e;Z&&null!==(e=Z.extra)&&void 0!==e&&e.frame&&oe(Z.extra.frame)}),[Z,oe]),(0,l.useEffect)((function(){E.current&&(de?E.current.play():E.current.pause())}),[de,E]),(0,l.useEffect)((function(){E.current&&(1===pe?E.current.setPlayerDirection(1):E.current.setPlayerDirection(-1))}),[pe,E]),(0,l.useEffect)((function(){E.current&&Re&&E.current.pause()}),[Re,Ne]);var Ee=(0,l.useCallback)((function(e){if($&&ye&&2===be.length&&void 0!==be[0]&&void 0!==be[1])if(be[0]<be[1]){if($.setDirection(1),ve(1),"frame"===e&&$.currentFrame<be[1]&&$.currentFrame<$.totalFrames)return void($.currentFrame<be[0]&&$.goToAndPlay(be[0],!0));var n=be[0];be[0]>=le&&(n=le-1),$.isPaused||(Fe===K.Nn.Loop&&($.goToAndPlay(n,!0),oe(be[0]),je(!0),me(!0)),Fe===K.Nn.PlayOnce&&($.goToAndStop(n,!0),oe(n),z(""),me(!1)))}else if(be[0]>be[1]){$.setDirection(-1),ve(-1);var t=be[0];if(be[0]>=le&&(t=le-1),!$.isPaused&&"frame"===e&&($.currentFrame<be[1]||$.currentFrame>be[0]||Math.floor($.currentFrame)<=0||$.currentFrame>$.totalFrames)){if(Fe===K.Nn.PlayOnce&&(Math.floor($.currentFrame)<be[1]||Math.floor($.currentFrame)<=0))return $.goToAndStop(t,!0),me(!1),je(!1),z(""),void oe(t);me(!0),$.goToAndPlay(t,!0),je(!0),oe(t)}}}),[ve,je,$,ye,z,be,Fe,me,le,oe]);(0,l.useEffect)((function(){Ee("frame")}),[be,Ee]);var Pe=(0,l.useCallback)((function(e){if($){if("load"===e){var n,t;if(Z&&null!==(n=Z.extra)&&void 0!==n&&n.frame)oe(null===(t=Z.extra)||void 0===t?void 0:t.frame);else S.frame||(null==$||$.goToAndPlay(0),oe(0));me(!0),Ee("frame")}"play"===e&&me(!0),"pause"===e&&me(!1),"loop"===e&&$&&Ee("loop"),"frame"===e&&$&&Ee("frame"),oe(Math.floor($.currentFrame))}}),[Z,$,Ee,me,S,oe]);(0,l.useEffect)((function(){$&&ie($.totalFrames)}),[$,ie]);var De=(0,l.useCallback)((function(e){ee(e),ye&&Ee("frame")}),[ye,Ee]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(i.Z,{className:"relative flex items-center justify-center w-full h-full overflow-hidden",children:(0,g.jsxs)("div",{className:a()({"absolute transition-all ease-linear delay-faster":!0,"hover:border":!q&&t,"comment-cursor":t}),ref:P,onClick:Se,onMouseEnter:Ze,onMouseLeave:Ze,style:{width:"".concat(33*T,"%"),height:"auto"},role:"presentation",children:[F&&t&&"comments"===Y&&(0,g.jsx)(V,{portal:I,mentionables:b,currentFrame:re,currentUserId:x,entityId:p,entityType:v,isPlaying:de,onDelete:C,onEdit:y,onReply:k,onResolve:w,onUnresolve:N,onSelectReaction:R}),F&&t&&"comments"===Y&&M&&(0,g.jsx)(O,{portalRoot:I,annotateComment:M,mentionables:b,setAnnotateComment:U,onPost:j}),(0,g.jsx)(f.J5,{autoplay:!0,loop:!0,onEvent:Pe,playerRef:E,lottieRef:De,src:n},"string"==typeof n?n:"")]})}),o&&(0,g.jsx)("div",{className:"absolute w-full max-w-md py-4 pr-8 mx-auto bottom-10",children:E.current&&$&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(H,{showComments:Boolean(F&&t),player:E.current,commentPortalRoot:I,currentFrame:re,entityId:p,entityType:v,instance:$,mentionables:b,playing:de,isLight:h,onPostComment:j}),(0,g.jsx)(X,{currentFrame:re||0,totalFrames:le})]})})]})}},57273:function(e,n,t){t.d(n,{L:function(){return m}});var r=t(89303),o=t(29901),a=t(46019),s=t(40810),l=t(7092),i=t(31054),c=t(53620),u=t(49046),d=t(61250),m=function(){var e=(0,a.useRecoilState)(s.EG),n=(0,r.Z)(e,2),t=n[0],m=n[1],f=.25,x=(0,o.useCallback)((function(){m(t+f)}),[t,m]),p=(0,o.useCallback)((function(){t>f&&m(t-f)}),[t,m]),v=(0,o.useCallback)((function(){m(1)}),[m]),h=(0,o.useMemo)((function(){return(0,d.jsx)(c.z,{keys:["+"],metaKey:!0})}),[]),b=(0,o.useMemo)((function(){return(0,d.jsx)(c.z,{keys:["-"],metaKey:!0})}),[]),g=(0,o.useMemo)((function(){return(0,d.jsx)(c.z,{keys:["0"],metaKey:!0})}),[]);return(0,u.Z)({key:"=",action:x,dependencies:[t],metaKeyRequired:!0}),(0,u.Z)({key:"-",action:p,dependencies:[t],metaKeyRequired:!0}),(0,u.Z)({key:"0",action:v,dependencies:[t],metaKeyRequired:!0}),(0,d.jsxs)("div",{className:"flex flex-col bg-white border-gray-100 divide-y rounded-md shadow-sm",children:[(0,d.jsx)(i.u,{title:"Zoom in",shortcut:h,children:(0,d.jsx)(l.h,{name:"plus",onClick:x,darker:!0,rounded:!0,backgroundColor:"white",hoverIconClass:"hover:text-teal-500",noFocus:!0})}),(0,d.jsx)(i.u,{title:"Reset zoom",shortcut:g,children:(0,d.jsxs)("div",{className:"flex items-center justify-center flex-shrink-0 text-gray-900 bg-white h-14 font-lf-semi-bold",style:{fontSize:"8px"},onClick:v,onKeyDown:function(){},children:[100*t,"%"]})}),(0,d.jsx)(i.u,{title:"Zoom out",shortcut:b,children:(0,d.jsx)(l.h,{name:"minus",onClick:p,darker:!0,rounded:!0,backgroundColor:"white",hoverIconClass:"hover:text-teal-500",noFocus:!0})})]})}},9482:function(e,n,t){t.d(n,{z:function(){return f}});var r=t(77916),o=t(69452),a=t(51848),s=t(29901),l=t(46133),i=t(2512),c=t(61250),u=["additionalClass","children","className","color","customClasses","disabled","fluid","fontClasses","icon","iconSize","onClick","padding","showLoader","type","variant","width"];function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function m(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var f=(0,s.forwardRef)((function(e,n){var t=e.additionalClass,r=e.children,s=(e.className,e.color),d=e.customClasses,f=e.disabled,x=e.fluid,p=e.fontClasses,v=e.icon,h=e.iconSize,b=e.onClick,g=e.padding,C=e.showLoader,y=(e.type,e.variant),j=e.width,k=(0,a.Z)(e,u),w=["relative","flex","items-center","justify-center","rounded-md"];switch(w=[].concat((0,o.Z)(w),v?["pl-2","pr-4","py-1"]:g?[g]:["px-4","py-1"]),x&&(w=[].concat((0,o.Z)(w),["w-full"])),y){case"secondary":w=[].concat((0,o.Z)(w),[p||"text-sm",j||"","bg-gray-100","hover:bg-gray-100","focus:bg-gray-100","focus:outline-none","focus:ring-2","disabled:bg-gray-100","disabled:opacity-30","disabled:cursor-not-allowed"]),w=[].concat((0,o.Z)(w),"teal"===s?["text-gray-900","focus:ring-teal-300"]:s?["text-".concat(s,"-700"),"focus:ring-".concat(s,"-100")]:["text-gray-900","focus:ring-teal-300"]);break;case"tertiary":w=[].concat((0,o.Z)(w),["border",p||"text-sm",j||"","focus:outline-none","focus:ring-2","disabled:opacity-30","disabled:cursor-not-allowed"]),w=[].concat((0,o.Z)(w),s?["border-".concat(s,"-500"),"text-".concat(s,"-700"),"hover:border-".concat(s,"-700"),"focus:border-".concat(s,"-500"),"focus:ring-".concat(s,"-200")]:["border-gray-300","text-gray-900","hover:border-gray-600","focus:border-gray-300","focus:ring-teal-300"]);break;case"ghost":w=[].concat((0,o.Z)(w),["border border-transparent",p||"text-sm",j||"","focus:outline-none","focus:ring-2","disabled:opacity-30","disabled:cursor-not-allowed"]),w=[].concat((0,o.Z)(w),s?["border-".concat(s,"-500"),"text-".concat(s,"-700"),"hover:border-".concat(s,"-700"),"focus:border-".concat(s,"-500"),"focus:ring-".concat(s,"-200")]:["hover:border-gray-300","text-gray-900","hover:border-gray-600","focus:border-gray-300","focus:ring-teal-300"]);break;default:w=[].concat((0,o.Z)(w),[j||"",p||"text-sm","text-sm","text-white","focus:outline-none","disabled:opacity-30","disabled:cursor-not-allowed"]),w=[].concat((0,o.Z)(w),"teal"===s?["bg-teal-300","hover:bg-teal-400","disabled:bg-teal-600"]:"gray"===s?["bg-gray-900","hover:bg-".concat(s,"-900"),"disabled:bg-".concat(s,"-600")]:s?["bg-".concat(s,"-500"),"hover:bg-".concat(s,"-700"),"disabled:bg-".concat(s,"-500")]:["bg-teal-300","hover:bg-teal-400","disabled:bg-teal-600"])}return d&&w.concat(d),t&&w.push(t),(0,c.jsxs)("button",m(m({type:"button",ref:n,className:d||w.join(" "),disabled:f||C,onClick:b},k),{},{children:[C&&(0,c.jsx)("div",{className:"absolute top-0 left-0 z-10 flex items-center justify-center w-full h-full pointer-events-none bg-gray-50 opacity-90",children:(0,c.jsx)(l.$,{size:5})}),v&&!h&&(0,c.jsx)(i.J,{name:v,marginRight:!0}),v&&h&&"small"===h&&(0,c.jsx)(i.J,{small:!0,name:v,marginRight:!0}),v&&h&&"medium"===h&&(0,c.jsx)(i.J,{medium:!0,name:v,marginRight:!0}),v&&h&&"large"===h&&(0,c.jsx)(i.J,{large:!0,name:v,marginRight:!0}),r]}))}));f.displayName="Button"},96772:function(e,n,t){t.d(n,{nR:function(){return i},jV:function(){return c},ud:function(){return u}});var r=t(29901),o=t(89741),a=t(2512),s=t(35378),l=t(61250),i=function(e){var n=e.description,t=e.descriptionColor,o=e.href,s=e.icon,i=e.label,c=e.labelClasses,u=e.onClick,d=e.rightControl,m=e.selected,f=e.tag,x=void 0===f?"a":f,p=e.wrapperCssClasses,v=void 0===p?"flex text-gray-600 hover:bg-gray-50 hover:text-gray-600 transition-colors rounded-md items-center px-2 font-lf-regular":p,h=r.createElement(x,{className:v,href:o,onClick:u},(0,l.jsx)(l.Fragment,{children:n?(0,l.jsxs)("div",{className:"flex flex-col w-full py-2 text-sm cursor-pointer",children:[(0,l.jsxs)("div",{className:"".concat(c||""," flex items-center w-full space-x-2"),children:[(0,l.jsx)("div",{className:"text-sm",children:i}),m&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"flex-grow"}),(0,l.jsx)("div",{className:"flex items-center ml-auto",children:(0,l.jsx)(a.J,{name:"tick",color:"text-gray-600",small:!0})})]})]}),(0,l.jsx)("p",{className:"".concat(t||"text-gray-900"),children:n})]}):(0,l.jsxs)("div",{className:"flex items-center w-full h-8 space-x-2 text-sm cursor-pointer",children:[s,(0,l.jsx)("div",{className:"text-sm",children:i}),m&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"flex-grow"}),(0,l.jsx)("div",{className:"flex items-center ml-auto",children:(0,l.jsx)(a.J,{name:"tick",color:"text-gray-600",small:!0})})]}),d&&(0,l.jsx)("div",{className:"flex items-center ml-auto",children:d})]})}));return(0,l.jsx)("div",{children:h})},c=function(e){return e&&e.value&&"string"==typeof e.value},u=function(e){var n,t=e.button,u=e.buttonType,d=void 0===u?"SelectorType":u,m=e.interaction,f=void 0===m?"click":m,x=e.onChange,p=e.options,v=e.placement,h=void 0===v?"top":v,b=e.selection,g=e.staticButton,C=void 0!==g&&g,y=e.width,j=void 0===y?"w-48":y,k=e.wrapperCssClasses,w=(0,r.useState)(b),R=w[0],N=w[1],I=(0,r.useState)(!1),F=I[0],S=I[1];(0,r.useEffect)((function(){F&&S(!1)}),[F]),n=C?t:R?"MenuType"===d?(0,l.jsx)(s.Xi,{icon:R.icon,rightControl:(0,l.jsx)(a.J,{name:"chevron-right",color:"text-gray-500"}),label:R.label}):(0,l.jsx)(i,{wrapperCssClasses:"flex text-gray-600 hover:bg-gray-50 hover:text-gray-600 transition-colors rounded-md h-8 items-center px-4 font-lf-regular",label:R.label,icon:R.icon,rightControl:(0,l.jsx)("div",{className:"text-gray-500",children:(0,l.jsx)(a.J,{name:"chevron-down-fill",small:!0})})}):c(t)?"MenuType"===d?(0,l.jsx)(s.Xi,{icon:t.icon,rightControl:(0,l.jsx)(a.J,{name:"chevron-right",color:"text-gray-500"}),label:t.label}):(0,l.jsx)(i,{wrapperCssClasses:"flex text-gray-900 hover:bg-gray-50 hover:text-gray-900 transition-colors rounded-md h-8 items-center px-4 font-lf-regular",label:t.label,icon:t.icon,rightControl:(0,l.jsx)("div",{className:"text-gray-500",children:(0,l.jsx)(a.J,{name:"chevron-down-fill",small:!0})})}):t;var Z=(0,o.x)().containerRef;return(0,l.jsx)(o.L,{container:null==Z?void 0:Z.current,wrapperCssClasses:k,placement:h,button:n,forceClose:F,interaction:f,menu:(0,l.jsx)("div",{className:"bg-white border border-gray-100 shadow-md rounded-md outline-none p-2 ".concat(j),children:p.map((function(e,n){var t="key-".concat(n);return c(e)?(0,l.jsx)(i,{label:e.label,icon:e.icon,onClick:function(){var n,t;n=e.label,t=p.find((function(e){return c(e)&&e.label===n?e:null})),c(t)&&(N(t),x&&x(t)),S(!0)},selected:(null==R?void 0:R.label)===e.label,description:e.description,labelClasses:e.labelClasses,descriptionColor:e.descriptionColor},t):r.isValidElement(e)?e:null}))})})}},65992:function(e,n,t){t.d(n,{n:function(){return l}});var r=t(29901),o=t(7092),a=t(31054),s=t(61250),l=(0,r.forwardRef)((function(e,n){var t=e.disabled,r=e.icon,l=e.iconColorClass,i=e.onClick,c=e.shortcut,u=e.title;return(0,s.jsx)(a.u,{title:u,shortcut:c,children:(0,s.jsx)(o.h,{ref:n,name:r,onClick:function(){i&&i()},rounded:!0,backgroundColor:"white",iconClass:l,noFocus:!0,darker:!0,disabled:t})})}));l.displayName="FloatingControl"},733:function(e,n,t){t.d(n,{es:function(){return x},X0:function(){return p},us:function(){return v},VP:function(){return h},UR:function(){return b},_i:function(){return g},OL:function(){return C}});var r=t(51848),o=t(55312),a=t(89303),s=t(24642),l=t.n(s),i=t(68668),c=t(29901),u=t(81638),d=t(64048),m=t(16824),f=["coordinates","frame","name"],x=function(e){var n=e.entityGroupId,t=e.entityId,s=void 0===t?"":t,x=e.isEnabled,p=e.workspaceId,v=(0,u.Db)(d.lC),h=(0,a.Z)(v,2)[1],b=(0,c.useCallback)(function(){var e=(0,o.Z)(l().mark((function e(t){var o,a,c,u,d,v,b,g,C,y,j,k;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.coordinates,u=t.frame,d=t.name,v=(0,r.Z)(t,f),x){e.next=3;break}return e.abrupt("return");case 3:return b=v.body.trim(),g={},C=i.td.General,"number"==typeof u&&(g.frame=u,g.type=c?m.CX.Annotation:m.CX.Keyframe,C=c?i.td.Annotated:i.td.Keyframe,c&&((y={}).type=m.TL.Point,y.x=c.x,y.y=c.y,c.ratio&&(y.ratio=[c.ratio.x,c.ratio.y]),g.annotation=y)),e.next=9,h({input:{entityId:s,type:m.TY.FileVersion,body:b,name:d,extra:"number"==typeof u?g:null}});case 9:j=e.sent,k=null===(o=j.data)||void 0===o?void 0:o.commentCreate,(0,i.Z9)(new i.qq({commentId:null==k?void 0:k.id,commentMentionIncluded:Boolean(null==k||null===(a=k.mentions)||void 0===a?void 0:a.length),commentType:C,commentSubType:i.pl.NewComment,fileId:n,fileVersionId:s,workspaceId:p}));case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[n,s,p,h]);return b},p=function(e){var n=e.entityGroupId,t=e.entityId,r=void 0===t?"":t,s=e.isEnabled,m=e.workspaceId,f=(0,u.Db)(d.Di),x=(0,a.Z)(f,2)[1],p=(0,c.useCallback)(function(){var e=(0,o.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,x({id:t});case 4:(0,i.Z9)(new i.AG({commentId:t,fileId:n,fileVersionId:r,workspaceId:m}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[r,n,m,x]);return p},v=function(e){var n=e.entityGroupId,t=e.entityId,r=void 0===t?"":t,s=e.isEnabled,f=e.workspaceId,x=(0,u.Db)(d.rZ),p=(0,a.Z)(x,2)[1],v=(0,c.useCallback)(function(){var e=(0,o.Z)(l().mark((function e(t,o){var a,c,u,d,x,v;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return u=o.trim(),e.next=5,p({id:t,body:u});case 5:d=e.sent,x=null===(a=d.data)||void 0===a?void 0:a.commentEdit,v=i.td.General,x.extra&&(v=x.extra.type===m.CX.Annotation?i.td.Annotated:i.td.Keyframe),(0,i.Z9)(new i.bm({commentId:t,commentType:v,commentMentionIncluded:Boolean(null==x||null===(c=x.mentions)||void 0===c?void 0:c.length),commentSubType:i.pl.EditComment,fileId:n,fileVersionId:r,workspaceId:f}));case 10:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),[r,n,f,p]);return v},h=function(e){var n=e.entityGroupId,t=e.entityId,r=void 0===t?"":t,s=e.isEnabled,m=e.workspaceId,f=(0,u.Db)(d.Lq),x=(0,a.Z)(f,2)[1],p=(0,c.useCallback)(function(){var e=(0,o.Z)(l().mark((function e(t,o,a){var c,u,d,f;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return u=o.trim(),e.next=5,x({id:t,body:u,name:a});case 5:d=e.sent,f=d.data.commentReplyCreate,(0,i.Z9)(new i.qq({parentId:t,commentId:f.id,commentType:i.td.Reply,commentSubType:i.pl.ReplyComment,commentMentionIncluded:Boolean(null===(c=f.mentions)||void 0===c?void 0:c.length),fileId:n,fileVersionId:r,workspaceId:m}));case 8:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),[n,r,m,x]);return p},b=function(e){var n=e.entityGroupId,t=e.entityId,r=void 0===t?"":t,s=e.isEnabled,m=e.workspaceId,f=(0,u.Db)(d.WS),x=(0,a.Z)(f,2)[1],p=(0,c.useCallback)(function(){var e=(0,o.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,x({id:t});case 4:(0,i.Z9)(new i.rP({commentId:t,fileId:n,fileVersionId:r,workspaceId:m}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[n,r,m,x]);return p},g=function(e){var n=e.entityGroupId,t=e.entityId,r=void 0===t?"":t,s=e.isEnabled,m=e.workspaceId,f=(0,u.Db)(d.dC),x=(0,a.Z)(f,2)[1],p=(0,c.useCallback)(function(){var e=(0,o.Z)(l().mark((function e(t){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,x({id:t});case 4:(0,i.Z9)(new i.ci({commentId:t,fileId:n,fileVersionId:r,workspaceId:m}));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[r,n,m,x]);return p},C=function(e){var n=e.entityGroupId,t=e.entityId,r=void 0===t?"":t,o=e.isEnabled,s=e.workspaceId,l=(0,u.Db)(d.ns),m=(0,a.Z)(l,2)[1],f=(0,u.Db)(d.PS),x=(0,a.Z)(f,2)[1],p=(0,c.useCallback)((function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o&&(a?(x({id:e,type:t}),(0,i.Z9)(new i.RD({commentId:e,reactionType:t,fileId:n,fileVersionId:r,workspaceId:s}))):(m({id:e,type:t}),(0,i.Z9)(new i.Gf({commentId:e,reactionType:t,fileId:n,fileVersionId:r,workspaceId:s}))))}),[o,r,n,s,m,x]);return p}},48550:function(e,n,t){t.d(n,{M:function(){return f}});var r=t(55312),o=t(89303),a=t(24642),s=t.n(a),l=t(29901),i=t(81638),c=t(19677),u=t(69896),d=t(64048),m=t(64167),f=function(e){var n,t=e.entityId,a=e.entityType,f=(0,l.useState)(null),x=f[0],p=f[1],v=(0,l.useState)(u.H.DiscussionMode),h=v[0],b=v[1],g=(0,l.useState)(!1),C=g[0],y=g[1],j=(0,i.m8)(),k=(0,i.aM)({query:d.wR,variables:{id:t,type:a,first:12},pause:!t}),w=(0,o.Z)(k,1)[0],R=(0,l.useCallback)((function(e){p(e),b(e?u.H.ReplyMode:u.H.DiscussionMode)}),[]),N=(0,l.useCallback)((function(){p(null),b(u.H.DiscussionMode)}),[]),I=(0,l.useCallback)((0,r.Z)(s().mark((function e(){var n,o,l,i,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&a){e.next=2;break}return e.abrupt("return");case 2:o=(null===(n=w.data)||void 0===n?void 0:n.comments.edges)||[],l=[],i=function(){var e=(0,r.Z)(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,j.query(d.wR,{id:t,type:a,first:12,after:n.cursor},{requestPolicy:"network-only"}).toPromise();case 5:return e.next=7,(0,m._v)(1e3);case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(n){return e.apply(this,arguments)}}(),c=0;case 6:if(!(c<o.length)){e.next=13;break}if(c&&c%11==0){e.next=9;break}return e.abrupt("continue",10);case 9:l.push(i(o[c]));case 10:c+=1,e.next=6;break;case 13:return e.next=15,Promise.all(l);case 15:case"end":return e.stop()}}),e)}))),[t,a,null===(n=w.data)||void 0===n?void 0:n.comments.edges]),F=(0,l.useCallback)((0,r.Z)(s().mark((function e(){var n,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w.data&&!w.fetching){e.next=2;break}return e.abrupt("return");case 2:if(null!==(n=w.data.comments.pageInfo)&&void 0!==n&&n.hasNextPage){e.next=4;break}return e.abrupt("return");case 4:if(null!==(r=w.data.comments.pageInfo)&&void 0!==r&&r.endCursor){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,j.query(d.wR,{id:t,type:a,after:w.data.comments.pageInfo.endCursor,first:12}).toPromise();case 9:return e.prev=9,e.finish(9);case 11:case"end":return e.stop()}}),e,null,[[6,,9,11]])}))),[j,w.data,w.fetching,t,a]);return(0,l.useEffect)((function(){var e=function(){y(Boolean(document.hidden))};return document.addEventListener("visibilitychange",e,!1),function(){document.removeEventListener("visibilitychange",e,!1)}}),[]),(0,c.Y)({task:I,pause:!t||C}),(0,l.useMemo)((function(){var e,n;return{canFetchMoreComments:(null===(e=w.data)||void 0===e||null===(n=e.comments.pageInfo)||void 0===n?void 0:n.hasNextPage)||!1,commentsQuery:w,onFetchMoreComments:F,onHideReplies:N,onShowReplies:R,parentComment:x,pushoverMode:h}}),[w,w.data,F,N,R,x,h])}},19677:function(e,n,t){t.d(n,{Y:function(){return o}});var r=t(29901),o=function(e){var n=e.executeOnInit,t=void 0!==n&&n,o=e.interval,a=void 0===o?12e5:o,s=e.pause,l=void 0!==s&&s,i=e.task;(0,r.useEffect)((function(){if(i&&!l){t&&i();var e=setInterval((function(){i()}),a);return function(){clearInterval(e)}}return function(){}}),[i,l,t,a])}},60873:function(e,n,t){t.d(n,{J:function(){return d}});var r=t(55312),o=t(89303),a=t(24642),s=t.n(a),l=t(29901),i=t(81638),c=t(19677),u=t(64048),d=function(e){var n=e.parentCommentId,t=(0,i.m8)(),a=(0,l.useState)(!1),d=a[0],m=a[1],f=(0,i.aM)({query:u.ki,variables:{id:n},pause:!n}),x=(0,o.Z)(f,1)[0],p=(0,l.useCallback)((0,r.Z)(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.query(u.ki,{id:n,first:(null===(r=x.data)||void 0===r?void 0:r.commentReplies.edges.length)||12},{requestPolicy:"cache-and-network"}).toPromise();case 4:case"end":return e.stop()}}),e)}))),[t,n]),v=(0,l.useCallback)((0,r.Z)(s().mark((function e(){var r,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.data&&!x.fetching){e.next=2;break}return e.abrupt("return");case 2:if(null!==(r=x.data.commentReplies.pageInfo)&&void 0!==r&&r.hasNextPage){e.next=4;break}return e.abrupt("return");case 4:if(null!==(o=x.data.commentReplies.pageInfo)&&void 0!==o&&o.endCursor){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,t.query(u.ki,{id:n,after:x.data.commentReplies.pageInfo.endCursor}).toPromise();case 9:return e.prev=9,e.finish(9);case 11:case"end":return e.stop()}}),e,null,[[6,,9,11]])}))),[t,x.data,x.fetching,n]);return(0,l.useEffect)((function(){var e=function(){m(Boolean(document.hidden))};return document.addEventListener("visibilitychange",e,!1),function(){document.removeEventListener("visibilitychange",e,!1)}}),[]),(0,c.Y)({task:p,pause:!n||d}),(0,l.useMemo)((function(){var e,n;return{repliesQuery:x,onFetchMoreReplies:v,canFetchMoreReplies:Boolean(null===(e=x.data)||void 0===e||null===(n=e.commentReplies.pageInfo)||void 0===n?void 0:n.hasNextPage)}}),[x,x.data,v])}},51705:function(e,n,t){t.d(n,{kF:function(){return u},YC:function(){return c},GS:function(){return l},VY:function(){return s},sq:function(){return a},IS:function(){return o},vQ:function(){return i}});var r=t(46019),o=(0,r.atom)({key:"playerIsPlaying",default:!0}),a=(0,r.atom)({key:"playerDirection",default:1}),s=(0,r.atom)({key:"playerCurrentSegment",default:[]}),l=(0,r.atom)({key:"playerCurrentPlayType",default:"loop"}),i=(0,r.atom)({key:"playerIsUsingSegment",default:!1}),c=(0,r.atom)({key:"playerCurrSegmentId",default:""}),u=(0,r.atom)({key:"isPlayerPlayOnHover",default:!1})},16824:function(e,n,t){var r,o,a,s;t.d(n,{TL:function(){return r},CX:function(){return o},ow:function(){return a},TY:function(){return s},Lt:function(){return l}}),function(e){e.Point="Point"}(r||(r={})),function(e){e.Annotation="Annotation",e.Keyframe="Keyframe"}(o||(o={})),function(e){e.User="UserMention"}(a||(a={})),function(e){e.FileVersion="FileVersion"}(s||(s={}));var l=function(e){return e.flatMap((function(e){var n,t;return null!==(n=null===(t=e.node.extra)||void 0===t?void 0:t.frame)&&void 0!==n?n:[]})).sort((function(e,n){return e-n})).filter((function(e,n,t){return n===t.length-1||t[n+1]!==e}))}}}]);